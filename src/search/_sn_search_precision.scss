// YEAR 3000: PRECISION TARGETING MODULE - FLUX REVOLUTION
// === UNIFIED SEARCH CONSCIOUSNESS - Gradient System Integration ===
// Eliminates color fragmentation and creates seamless Year 3000 search experience

@use "../core/mixins" as *;

// =============================================================================
// SEARCH CONSCIOUSNESS VARIABLES - Gradient System Integration
// =============================================================================

:root {
  // Search-specific gradient harmonics (extends main gradient system)
  --sn-search-gradient-primary: var(--sn-gradient-primary);
  --sn-search-gradient-secondary: var(--sn-gradient-secondary);
  --sn-search-gradient-accent: var(--sn-gradient-accent);

  // RGB versions for precise control
  --sn-search-gradient-primary-rgb: var(--sn-gradient-primary-rgb);
  --sn-search-gradient-secondary-rgb: var(--sn-gradient-secondary-rgb);
  --sn-search-gradient-accent-rgb: var(--sn-gradient-accent-rgb);

  // Search-specific intensity modulation (enhanced for visibility without white boxes)
  --sn-search-intensity: 0.15; // Increased from 0.1 for better vibrancy visibility
  --sn-search-depth-factor: 0.1; // Enhanced from 0.07 for more layered effects
  --sn-search-harmony-factor: 0.12; // Increased from 0.08 for stronger accent touches

  // HARMONY ENGINE INTEGRATION - Dynamic contrast boost with enhanced vibrancy
  --sn-search-contrast-boost: 1; // Set by harmony engine when needed
  --sn-search-fallback-primary: var(
    --sn-gradient-primary,
    #8caaee
  ); // Harmony engine fallback using default StarryNight accent

  // Enhanced intensity with harmony boost support - more vibrant defaults
  --sn-search-intensity-boosted: calc(
    var(--sn-search-intensity) * var(--sn-search-contrast-boost, 1)
  );
  --sn-search-depth-factor-boosted: calc(
    var(--sn-search-depth-factor) * var(--sn-search-contrast-boost, 1)
  );
  --sn-search-harmony-factor-boosted: calc(
    var(--sn-search-harmony-factor) * var(--sn-search-contrast-boost, 1)
  );

  // Temporal transition system
  --sn-search-transition-organic: var(--sn-gradient-transition);
  --sn-search-transition-quick: 400ms var(--sn-easing-emergence);
}

// =============================================================================
// UNIFIED SEARCH CONTAINER - Gradient Consciousness Extension
// =============================================================================

.main-searchPage-content {
  position: relative;

  // Unified gradient foundation (extends main gradient system)
  &::before {
    content: "";
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: -10;
    background:
      // Primary gradient layer matching main system
      radial-gradient(
        ellipse at 30% 20%,
        rgba(var(--sn-search-gradient-primary-rgb), var(--sn-search-intensity))
          0%,
        transparent 60%
      ),
      // Secondary harmonic
      radial-gradient(
          ellipse at 70% 80%,
          rgba(
              var(--sn-search-gradient-secondary-rgb),
              var(--sn-search-depth-factor)
            )
            0%,
          transparent 50%
        ),
      // Accent layer for depth
      linear-gradient(
          135deg,
          rgba(
              var(--sn-search-gradient-accent-rgb),
              var(--sn-search-harmony-factor)
            )
            0%,
          transparent 40%,
          transparent 60%,
          rgba(
              var(--sn-search-gradient-primary-rgb),
              calc(var(--sn-search-intensity) * 0.5)
            )
            100%
        );
    transition: all var(--sn-search-transition-organic);

    // Performance optimization
    will-change: var(--sn-gpu-acceleration);
    transform: translateZ(0);
    @include performance-optimized;
  }
}

// =============================================================================
// SEARCH RESULT SECTIONS - Unified Gradient Treatment
// =============================================================================

.main-shelf-shelf {
  position: relative;

  // Section header unification
  .main-shelf-header {
    position: relative;

    h2,
    h3,
    h4 {
      // Unified gradient text treatment
      background: linear-gradient(
        135deg,
        rgba(var(--sn-search-gradient-primary-rgb), 1) 0%,
        rgba(var(--sn-search-gradient-accent-rgb), 0.9) 60%,
        rgba(var(--sn-search-gradient-secondary-rgb), 0.8) 100%
      ) !important;
      -webkit-background-clip: text !important;
      background-clip: text !important;
      -webkit-text-fill-color: transparent !important;

      // Gentle enhancement glow
      text-shadow: 0 0 20px rgba(var(--sn-search-gradient-primary-rgb), 0.2) !important;
    }
  }
}

// =============================================================================
// CARD UNIFICATION - HIGH SPECIFICITY - Eliminate Color Fragmentation
// =============================================================================

// Increased specificity to override enhanced cards and other modules
body:has(.main-searchPage-content) .main-searchPage-content .main-card-card {
  // YEAR 3000 GRADIENT CONSCIOUSNESS - ELIMINATE WHITE BOXES
  background: transparent !important;
  border: 1px solid rgba(var(--sn-search-gradient-primary-rgb), 0.15) !important;
  border-radius: 12px !important;

  // Enhanced gradient overlay (stronger since no white background)
  &::before {
    content: "";
    position: absolute !important;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: -1;
    background: linear-gradient(
      135deg,
      rgba(
          var(--sn-search-gradient-primary-rgb),
          var(--sn-search-intensity-boosted)
        )
        0%,
      rgba(
          var(--sn-search-gradient-secondary-rgb),
          var(--sn-search-depth-factor-boosted)
        )
        50%,
      rgba(
          var(--sn-search-gradient-accent-rgb),
          var(--sn-search-harmony-factor-boosted)
        )
        100%
    ) !important;
    border-radius: inherit;
    transition: all var(--sn-search-transition-quick);
    pointer-events: none;
  }

  // Enhanced hover state (no white backgrounds)
  &:hover {
    background: transparent !important;
    border-color: rgba(
      var(--sn-search-gradient-primary-rgb),
      calc(0.25 * var(--sn-search-contrast-boost, 1))
    ) !important;

    &::before {
      background: linear-gradient(
        135deg,
        rgba(
            var(--sn-search-gradient-primary-rgb),
            calc(var(--sn-search-intensity-boosted) * 1.5)
          )
          0%,
        rgba(
            var(--sn-search-gradient-secondary-rgb),
            calc(var(--sn-search-depth-factor-boosted) * 1.5)
          )
          50%,
        rgba(
            var(--sn-search-gradient-accent-rgb),
            calc(var(--sn-search-harmony-factor-boosted) * 1.5)
          )
          100%
      ) !important;
    }
  }

  // Enhanced focus state
  &:focus-visible {
    outline: 2px solid rgba(var(--sn-search-gradient-primary-rgb), 0.8) !important;
    outline-offset: 2px;
  }
}

// =============================================================================
// TOP RESULT - Enhanced Gradient Signature - HIGH SPECIFICITY
// =============================================================================

body:has(.main-searchPage-content)
  [data-testid="top-result-card"]
  .main-card-card {
  // Pure gradient border for top result (NO WHITE BACKGROUND)
  border: 2px solid transparent !important;
  background: transparent,
    linear-gradient(
        135deg,
        rgba(var(--sn-search-gradient-primary-rgb), 0.4) 0%,
        rgba(var(--sn-search-gradient-accent-rgb), 0.3) 50%,
        rgba(var(--sn-search-gradient-secondary-rgb), 0.35) 100%
      )
      border-box !important;

  // Enhanced gradient overlay for top result
  &::before {
    background: linear-gradient(
      135deg,
      rgba(var(--sn-search-gradient-primary-rgb), 0.15) 0%,
      rgba(var(--sn-search-gradient-secondary-rgb), 0.1) 50%,
      rgba(var(--sn-search-gradient-accent-rgb), 0.12) 100%
    ) !important;
  }

  &:hover::before {
    background: linear-gradient(
      135deg,
      rgba(var(--sn-search-gradient-primary-rgb), 0.22) 0%,
      rgba(var(--sn-search-gradient-secondary-rgb), 0.16) 50%,
      rgba(var(--sn-search-gradient-accent-rgb), 0.18) 100%
    ) !important;
  }
}

// =============================================================================
// ALBUM ART & IMAGES - Unified Enhancement Treatment - HIGH SPECIFICITY
// =============================================================================

body:has(.main-searchPage-content) .main-searchPage-content {
  .main-image-image,
  .main-cardImage-image,
  .main-entityHeader-image {
    // Unified gradient enhancement
    filter: saturate(1.05) brightness(1.02) contrast(1.01) !important;
    position: relative;

    // Gentle gradient overlay on hover
    &::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(
        135deg,
        rgba(var(--sn-search-gradient-primary-rgb), 0.02) 0%,
        transparent 50%,
        rgba(var(--sn-search-gradient-accent-rgb), 0.01) 100%
      );
      opacity: 0;
      transition: opacity var(--sn-search-transition-quick);
      border-radius: inherit;
      pointer-events: none;
    }

    .main-card-card:hover & {
      &::after {
        opacity: 1;
      }
    }
  }
}

// =============================================================================
// ARTIST PAGES IN SEARCH - Gradient Consciousness Override - HIGH SPECIFICITY
// =============================================================================

// Override any entityHeader styling within search context
body:has(.main-searchPage-content) .main-entityHeader-container {
  // Pure gradient background treatment (NO WHITE BACKGROUNDS)
  background: transparent !important;

  // Enhanced gradient overlay that matches search system
  &::before {
    background: linear-gradient(
      180deg,
      rgba(
          var(--sn-search-gradient-primary-rgb),
          calc(var(--sn-search-intensity) * 1.5)
        )
        0%,
      rgba(
          var(--sn-search-gradient-secondary-rgb),
          calc(var(--sn-search-depth-factor) * 1.2)
        )
        40%,
      transparent 100%
    ) !important;
    opacity: 1 !important;
  }
}

// =============================================================================
// TEXT ELEMENTS - Enhanced Gradient Typography - HIGH SPECIFICITY
// =============================================================================

body:has(.main-searchPage-content) .main-searchPage-content {
  .main-cardHeader-text,
  .main-cardSubHeader-root,
  .main-type-mestoBold,
  .main-type-mesto {
    // Enhanced gradient text enhancement for important elements
    &:is(h1, h2, h3, h4, [data-testid*="title"]) {
      background: linear-gradient(
        135deg,
        rgba(var(--sn-oklab-processed-bright-highlight-rgb), 0.95) 0%,
        rgba(var(--sn-search-gradient-primary-rgb), 0.9) 100%
      ) !important;
      -webkit-background-clip: text !important;
      background-clip: text !important;
      -webkit-text-fill-color: transparent !important;
    }

    // Enhanced regular text visibility without white backgrounds
    color: rgba(255, 255, 255, 0.85) !important;
  }
}

// =============================================================================
// PLAY BUTTONS - Unified Gradient Treatment - HIGH SPECIFICITY
// =============================================================================

body:has(.main-searchPage-content) .main-searchPage-content {
  .main-playButton-PlayButton,
  .main-card-PlayButtonContainer button {
    // Unified gradient background
    background: linear-gradient(
      135deg,
      rgba(var(--sn-search-gradient-primary-rgb), 0.9) 0%,
      rgba(var(--sn-search-gradient-accent-rgb), 0.8) 100%
    ) !important;

    // Enhanced hover state
    &:hover {
      background: linear-gradient(
        135deg,
        rgba(var(--sn-search-gradient-primary-rgb), 1) 0%,
        rgba(var(--sn-search-gradient-accent-rgb), 0.9) 100%
      ) !important;

      box-shadow: 0 4px 12px rgba(var(--sn-search-gradient-primary-rgb), 0.3),
        0 0 0 3px rgba(var(--sn-search-gradient-primary-rgb), 0.1) !important;
    }
  }
}

// =============================================================================
// GRID CONTAINERS - Unified Layout Enhancement with Harmony Boost
// =============================================================================

body:has(.main-searchPage-content)
  .main-searchPage-content
  .main-gridContainer-gridContainer {
  // Harmony-boosted grid enhancement
  &::before {
    content: "";
    position: absolute;
    top: -8px;
    left: -8px;
    right: -8px;
    bottom: -8px;
    z-index: -1;
    background: radial-gradient(
      ellipse 120% 80% at center,
      rgba(
          var(--sn-search-gradient-primary-rgb),
          calc(0.02 * var(--sn-search-contrast-boost, 1))
        )
        0%,
      rgba(
          var(--sn-search-gradient-secondary-rgb),
          calc(0.01 * var(--sn-search-contrast-boost, 1))
        )
        40%,
      transparent 70%
    ) !important;
    opacity: 1;
    transform: scale(1);
    border-radius: 12px;
    pointer-events: none;
  }
}

// =============================================================================
// ALBUM ART & IMAGES - Harmony-Enhanced Treatment
// =============================================================================

body:has(.main-searchPage-content) .main-searchPage-content {
  .main-image-image,
  .main-cardImage-image,
  .main-entityHeader-image {
    // Unified gradient enhancement
    filter: saturate(1.05) brightness(1.02) contrast(1.01) !important;
    position: relative;

    // Harmony-boosted gradient overlay on hover
    &::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(
        135deg,
        rgba(
            var(--sn-search-gradient-primary-rgb),
            calc(0.02 * var(--sn-search-contrast-boost, 1))
          )
          0%,
        transparent 50%,
        rgba(
            var(--sn-search-gradient-accent-rgb),
            calc(0.01 * var(--sn-search-contrast-boost, 1))
          )
          100%
      );
      opacity: 0;
      transition: opacity var(--sn-search-transition-quick);
      border-radius: inherit;
      pointer-events: none;
    }

    .main-card-card:hover & {
      &::after {
        opacity: 1;
      }
    }
  }
}

// =============================================================================
// TEXT ELEMENTS - Harmony-Enhanced Typography
// =============================================================================

body:has(.main-searchPage-content) .main-searchPage-content {
  .main-cardHeader-text,
  .main-cardSubHeader-root,
  .main-type-mestoBold,
  .main-type-mesto {
    // Enhanced gradient text with harmony boost for titles
    &:is(h1, h2, h3, h4, [data-testid*="title"]) {
      background: linear-gradient(
        135deg,
        rgba(
            var(--sn-oklab-processed-bright-highlight-rgb),
            calc(0.95 * var(--sn-search-contrast-boost, 1))
          )
          0%,
        rgba(
            var(--sn-search-gradient-primary-rgb),
            calc(0.9 * var(--sn-search-contrast-boost, 1))
          )
          100%
      ) !important;
      -webkit-background-clip: text !important;
      background-clip: text !important;
      -webkit-text-fill-color: transparent !important;
    }

    // Enhanced regular text visibility with harmony boost
    color: rgba(
      255,
      255,
      255,
      calc(0.85 * var(--sn-search-contrast-boost, 1))
    ) !important;
  }
}

// =============================================================================
// PLAY BUTTONS - Harmony-Enhanced Gradient Treatment
// =============================================================================

body:has(.main-searchPage-content) .main-searchPage-content {
  .main-playButton-PlayButton,
  .main-card-PlayButtonContainer button {
    // Harmony-boosted gradient background
    background: linear-gradient(
      135deg,
      rgba(
          var(--sn-search-gradient-primary-rgb),
          calc(0.9 * var(--sn-search-contrast-boost, 1))
        )
        0%,
      rgba(
          var(--sn-search-gradient-accent-rgb),
          calc(0.8 * var(--sn-search-contrast-boost, 1))
        )
        100%
    ) !important;

    // Enhanced hover state with harmony boost
    &:hover {
      background: linear-gradient(
        135deg,
        rgba(
            var(--sn-search-gradient-primary-rgb),
            calc(1 * var(--sn-search-contrast-boost, 1))
          )
          0%,
        rgba(
            var(--sn-search-gradient-accent-rgb),
            calc(0.9 * var(--sn-search-contrast-boost, 1))
          )
          100%
      ) !important;

      box-shadow: 0 4px 12px
          rgba(
            var(--sn-search-gradient-primary-rgb),
            calc(0.3 * var(--sn-search-contrast-boost, 1))
          ),
        0 0 0 3px
          rgba(
            var(--sn-search-gradient-primary-rgb),
            calc(0.1 * var(--sn-search-contrast-boost, 1))
          ) !important;
    }
  }
}

// =============================================================================
// ARTIST PAGES IN SEARCH - Harmony-Enhanced Override
// =============================================================================

// Override any entityHeader styling within search context
body:has(.main-searchPage-content) .main-entityHeader-container {
  // Pure gradient background treatment (NO WHITE BACKGROUNDS)
  background: transparent !important;

  // Harmony-boosted gradient overlay
  &::before {
    background: linear-gradient(
      180deg,
      rgba(
          var(--sn-search-gradient-primary-rgb),
          calc(var(--sn-search-intensity-boosted) * 1.5)
        )
        0%,
      rgba(
          var(--sn-search-gradient-secondary-rgb),
          calc(var(--sn-search-depth-factor-boosted) * 1.2)
        )
        40%,
      transparent 100%
    ) !important;
    opacity: 1 !important;
  }
}

// =============================================================================
// ACCESSIBILITY & RESPONSIVE HARMONICS
// =============================================================================

@media (prefers-reduced-motion: reduce) {
  .main-searchPage-content * {
    animation: none !important;
    transition-duration: 0.1s !important;
  }
}

@media (max-width: 768px) {
  :root {
    // Responsive harmony boost scaling - enhanced for mobile vibrancy
    --sn-search-intensity: 0.12; // Increased from 0.08 to maintain vibrancy
    --sn-search-depth-factor: 0.08; // Increased from 0.06 to maintain depth
    --sn-search-harmony-factor: 0.1; // Increased from 0.07 to maintain accent presence

    // Ensure contrast boost is maintained on mobile
    --sn-search-intensity-boosted: calc(
      var(--sn-search-intensity) * var(--sn-search-contrast-boost, 1)
    );
    --sn-search-depth-factor-boosted: calc(
      var(--sn-search-depth-factor) * var(--sn-search-contrast-boost, 1)
    );
    --sn-search-harmony-factor-boosted: calc(
      var(--sn-search-harmony-factor) * var(--sn-search-contrast-boost, 1)
    );
  }
}

// =============================================================================
// YEAR 3000 HARMONY-INTEGRATED SEARCH SYSTEM COMPLETE
// =============================================================================
// This module creates a seamless Year 3000 gradient consciousness that flows
// throughout the search experience with intelligent contrast boosting from the
// harmony engine to ensure visibility regardless of extracted album colors
