// ████████████████████████████████████████████████████████████████████████████████
// ATMOSPHERIC SYSTEMS - Volumetric Visual Effects Environment
// ████████████████████████████████████████████████████████████████████████████████

// === ATMOSPHERIC VISUAL EFFECTS FOUNDATION ===
// Creates immersive atmospheric environments that respond to music and emotions:
// • Volumetric lighting with particle interactions
// • Atmospheric fog with organic movement
// • Environmental visual effects that adapts to content
// • Performance-optimized atmospheric rendering

// Volumetric lighting system
.dynamic-volumetric-lighting {
  // Core volumetric properties
  position: relative;
  contain: layout style paint;
  
  // Base atmospheric enhancement
  filter: 
    saturate(calc(1.0 + var(--visual-effects-emotional-saturation, 1) * 0.2))
    brightness(calc(1.0 + var(--visual-effects-warmth-factor, 0.8) * 0.1));
  
  // Volumetric breathing - DISABLED: Caused global app bouncing
  // animation: volumetric-breathing var(--visual-effects-breathing-cycle, 1s) ease-in-out infinite;
  
  // Performance optimization
  will-change: filter;
  transform: translateZ(0);
  
  // Primary light rays
  &::before {
    content: '';
    position: absolute;
    top: -20%;
    left: -20%;
    right: -20%;
    bottom: -20%;
    
    // Volumetric ray pattern
    background: 
      linear-gradient(
        45deg,
        transparent 0%,
        rgba(var(--dynamic-primary-rgb, 205, 214, 244), calc(var(--visual-effects-fog-opacity, 0.02) * 3)) 20%,
        transparent 25%,
        transparent 30%,
        rgba(var(--layered-effect-rgb, 116, 199, 236), calc(var(--visual-effects-fog-opacity, 0.02) * 2)) 50%,
        transparent 55%,
        transparent 70%,
        rgba(var(--dynamic-accent-rgb, 203, 166, 247), calc(var(--visual-effects-fog-opacity, 0.02) * 3)) 90%,
        transparent 95%
      ),
      linear-gradient(
        135deg,
        transparent 0%,
        rgba(var(--audio-visualization-rgb, 116, 199, 236), calc(var(--visual-effects-fog-opacity, 0.02) * 2)) 30%,
        transparent 35%,
        transparent 65%,
        rgba(var(--dynamic-primary-rgb, 205, 214, 244), calc(var(--visual-effects-fog-opacity, 0.02) * 2)) 85%,
        transparent 90%
      );
    
    background-size: 200px 200px, 150px 150px;
    
    // Light ray animation
    // animation: visual-effects-light-rays calc(var(--visual-effects-breathing-cycle, 1s) * 4) linear infinite;
    
    // Performance optimization
    pointer-events: none;
    z-index: var(--visual-effects-depth-atmosphere, 0);
    will-change: background-position, opacity;
    contain: strict;
    mix-blend-mode: screen;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.4);
  }
  
  // Secondary atmospheric glow
  &::after {
    content: '';
    position: absolute;
    top: -10%;
    left: -10%;
    right: -10%;
    bottom: -10%;
    
    // Atmospheric glow pattern
    background: radial-gradient(
      ellipse at 30% 20%,
      rgba(var(--dynamic-primary-rgb, 205, 214, 244), calc(var(--visual-effects-fog-opacity, 0.02) * 5)) 0%,
      rgba(var(--layered-effect-rgb, 116, 199, 236), calc(var(--visual-effects-fog-opacity, 0.02) * 3)) 30%,
      transparent 60%
    ), radial-gradient(
      ellipse at 70% 80%,
      rgba(var(--dynamic-accent-rgb, 203, 166, 247), calc(var(--visual-effects-fog-opacity, 0.02) * 4)) 0%,
      rgba(var(--audio-visualization-rgb, 116, 199, 236), calc(var(--visual-effects-fog-opacity, 0.02) * 2)) 40%,
      transparent 70%
    );
    
    // Atmospheric glow animation
    // animation: visual-effects-atmospheric-glow calc(var(--visual-effects-breathing-cycle, 1s) * 3) ease-in-out infinite;
    
    pointer-events: none;
    z-index: calc(var(--visual-effects-depth-atmosphere, 0) + 1);
    will-change: opacity, transform;
    contain: strict;
    mix-blend-mode: overlay;
  }
  
  // Lighting intensity levels
  &[data-light-intensity="ambient"] {
    --lighting-multiplier: 0.3;
    filter: 
      saturate(calc(1.0 + var(--visual-effects-emotional-saturation, 1) * 0.1))
      brightness(calc(1.0 + var(--visual-effects-warmth-factor, 0.8) * 0.05));
  }
  
  &[data-light-intensity="moderate"] {
    --lighting-multiplier: 0.7;
  }
  
  &[data-light-intensity="dramatic"] {
    --lighting-multiplier: 1.2;
    filter: 
      saturate(calc(1.0 + var(--visual-effects-emotional-saturation, 1) * 0.3))
      brightness(calc(1.0 + var(--visual-effects-warmth-factor, 0.8) * 0.15))
      contrast(calc(1.0 + var(--lighting-multiplier, 1.2) * 0.2));
    
    // Enhanced dramatic glow
    &::before {
      opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.7);
    }
    
    &::after {
      opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.6);
    }
  }
}

// Atmospheric particle system
.dynamic-atmospheric-particles {
  // Core particle properties
  position: relative;
  overflow: hidden;
  
  // Particle field base
  &::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    right: -50%;
    bottom: -50%;
    
    // Particle pattern
    background: 
      radial-gradient(circle at 20% 30%, rgba(var(--dynamic-primary-rgb, 205, 214, 244), calc(var(--layered-shimmer-opacity, 0.05) * 2)) 1px, transparent 2px),
      radial-gradient(circle at 60% 10%, rgba(var(--layered-effect-rgb, 116, 199, 236), calc(var(--layered-shimmer-opacity, 0.05) * 1.5)) 1px, transparent 2px),
      radial-gradient(circle at 40% 70%, rgba(var(--dynamic-accent-rgb, 203, 166, 247), calc(var(--layered-shimmer-opacity, 0.05) * 2)) 1px, transparent 2px),
      radial-gradient(circle at 80% 50%, rgba(var(--audio-visualization-rgb, 116, 199, 236), calc(var(--layered-shimmer-opacity, 0.05) * 1)) 1px, transparent 2px),
      radial-gradient(circle at 10% 80%, rgba(var(--dynamic-primary-rgb, 205, 214, 244), calc(var(--layered-shimmer-opacity, 0.05) * 1.5)) 1px, transparent 2px),
      radial-gradient(circle at 90% 20%, rgba(var(--dynamic-accent-rgb, 203, 166, 247), calc(var(--layered-shimmer-opacity, 0.05) * 1)) 1px, transparent 2px);
    
    background-size: 80px 80px, 120px 120px, 100px 100px, 150px 150px, 90px 90px, 110px 110px;
    
    // Particle floating animation
    // animation: organic-particle-float calc(var(--visual-effects-breathing-cycle, 1s) * 8) linear infinite;
    
    // Performance optimization
    pointer-events: none;
    z-index: var(--visual-effects-depth-atmosphere, 0);
    will-change: background-position, opacity;
    contain: strict;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.5);
  }
  
  // Enhanced particle layer
  &::after {
    content: '';
    position: absolute;
    top: -30%;
    left: -30%;
    right: -30%;
    bottom: -30%;
    
    // Additional particle layer
    background: 
      radial-gradient(circle at 35% 60%, rgba(var(--layered-effect-rgb, 116, 199, 236), calc(var(--layered-shimmer-opacity, 0.05) * 3)) 0.5px, transparent 1px),
      radial-gradient(circle at 75% 40%, rgba(var(--dynamic-primary-rgb, 205, 214, 244), calc(var(--layered-shimmer-opacity, 0.05) * 2)) 0.5px, transparent 1px),
      radial-gradient(circle at 15% 20%, rgba(var(--dynamic-accent-rgb, 203, 166, 247), calc(var(--layered-shimmer-opacity, 0.05) * 2.5)) 0.5px, transparent 1px),
      radial-gradient(circle at 85% 80%, rgba(var(--audio-visualization-rgb, 116, 199, 236), calc(var(--layered-shimmer-opacity, 0.05) * 2)) 0.5px, transparent 1px);
    
    background-size: 60px 60px, 70px 70px, 50px 50px, 80px 80px;
    
    // Secondary particle animation
    // animation: organic-particle-float calc(var(--visual-effects-breathing-cycle, 1s) * 6) linear infinite reverse;
    
    pointer-events: none;
    z-index: calc(var(--visual-effects-depth-atmosphere, 0) + 1);
    will-change: background-position;
    contain: strict;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.3);
  }
  
  // Particle density levels
  &[data-particle-density="sparse"] {
    &::before {
      opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.2);
    }
    
    &::after {
      opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.1);
    }
  }
  
  &[data-particle-density="moderate"] {
    &::before {
      opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.5);
    }
    
    &::after {
      opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.3);
    }
  }
  
  &[data-particle-density="dense"] {
    &::before {
      opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.8);
    }
    
    &::after {
      opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.6);
    }
    
    // Additional dense particle layer
    &::before {
      background-size: 40px 40px, 60px 60px, 50px 50px, 75px 75px, 45px 45px, 55px 55px;
    }
  }
}

// Organic fog system
.dynamic-atmospheric-fog {
  // Core fog properties
  position: relative;
  
  // Fog enhancement
  filter: 
    saturate(calc(1.0 + var(--visual-effects-emotional-saturation, 1) * 0.1))
    brightness(calc(1.0 + var(--visual-effects-warmth-factor, 0.8) * 0.05));
  
  // Fog breathing
  // animation: visual-effects-fog-breathing var(--visual-effects-breathing-cycle, 1s) ease-in-out infinite; // DISABLED: Caused global app bouncing
  
  // Primary fog layer
  &::before {
    content: '';
    position: absolute;
    top: -40%;
    left: -40%;
    right: -40%;
    bottom: -40%;
    
    // Organic fog gradient
    background: 
      radial-gradient(
        ellipse at 25% 75%,
        rgba(var(--visual-effects-atmosphere-rgb, 88, 91, 112), calc(var(--visual-effects-fog-opacity, 0.02) * 8)) 0%,
        rgba(var(--visual-effects-surface-rgb, 88, 91, 112), calc(var(--visual-effects-fog-opacity, 0.02) * 5)) 40%,
        transparent 70%
      ),
      radial-gradient(
        ellipse at 75% 25%,
        rgba(var(--visual-effects-atmosphere-rgb, 88, 91, 112), calc(var(--visual-effects-fog-opacity, 0.02) * 6)) 0%,
        rgba(var(--dynamic-primary-rgb, 205, 214, 244), calc(var(--visual-effects-fog-opacity, 0.02) * 3)) 50%,
        transparent 80%
      );
    
    // Fog drift animation
    // animation: visual-effects-fog-drift calc(var(--visual-effects-breathing-cycle, 1s) * 5) ease-in-out infinite;
    
    // Performance optimization
    pointer-events: none;
    z-index: var(--visual-effects-depth-atmosphere, 0);
    will-change: background-position, opacity;
    contain: strict;
    mix-blend-mode: multiply;
  }
  
  // Secondary fog layer
  &::after {
    content: '';
    position: absolute;
    top: -20%;
    left: -20%;
    right: -20%;
    bottom: -20%;
    
    // Secondary fog pattern
    background: 
      radial-gradient(
        circle at 60% 40%,
        rgba(var(--visual-effects-surface-rgb, 88, 91, 112), calc(var(--visual-effects-fog-opacity, 0.02) * 4)) 0%,
        transparent 60%
      ),
      radial-gradient(
        circle at 40% 60%,
        rgba(var(--visual-effects-atmosphere-rgb, 88, 91, 112), calc(var(--visual-effects-fog-opacity, 0.02) * 3)) 0%,
        transparent 70%
      );
    
    // Secondary fog animation
    // animation: visual-effects-fog-drift calc(var(--visual-effects-breathing-cycle, 1s) * 3) ease-in-out infinite reverse;
    
    pointer-events: none;
    z-index: calc(var(--visual-effects-depth-atmosphere, 0) + 1);
    will-change: background-position;
    contain: strict;
    mix-blend-mode: overlay;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.6);
  }
  
  // Fog density levels
  &[data-fog-type="light"] {
    --fog-multiplier: 0.4;
    
    &::before {
      background: radial-gradient(
        ellipse at center,
        rgba(var(--visual-effects-atmosphere-rgb, 88, 91, 112), calc(var(--visual-effects-fog-opacity, 0.02) * 3)) 0%,
        transparent 60%
      );
    }
  }
  
  &[data-fog-type="moderate"] {
    --fog-multiplier: 0.8;
  }
  
  &[data-fog-type="heavy"] {
    --fog-multiplier: 1.3;
    
    filter: 
      saturate(calc(1.0 + var(--visual-effects-emotional-saturation, 1) * 0.15))
      brightness(calc(1.0 + var(--visual-effects-warmth-factor, 0.8) * 0.08));
    
    &::before {
      background: 
        radial-gradient(
          ellipse at 25% 75%,
          rgba(var(--visual-effects-atmosphere-rgb, 88, 91, 112), calc(var(--visual-effects-fog-opacity, 0.02) * 12)) 0%,
          rgba(var(--visual-effects-surface-rgb, 88, 91, 112), calc(var(--visual-effects-fog-opacity, 0.02) * 8)) 30%,
          rgba(var(--visual-effects-atmosphere-rgb, 88, 91, 112), calc(var(--visual-effects-fog-opacity, 0.02) * 4)) 60%,
          transparent 80%
        ),
        radial-gradient(
          ellipse at 75% 25%,
          rgba(var(--visual-effects-surface-rgb, 88, 91, 112), calc(var(--visual-effects-fog-opacity, 0.02) * 10)) 0%,
          rgba(var(--dynamic-primary-rgb, 205, 214, 244), calc(var(--visual-effects-fog-opacity, 0.02) * 6)) 40%,
          transparent 70%
        );
    }
  }
}

// Environmental visual effects system
.dynamic-environmental-visual-effects {
  // Core environmental properties
  position: relative;
  
  // Add perceptual blending for enhanced environmental consciousness
  @extend .oklab-atmospheric-blend !optional;
  
  // Environmental filter enhancement
  filter: 
    saturate(calc(1.0 + var(--visual-effects-emotional-saturation, 1) * 0.25))
    brightness(calc(1.0 + var(--visual-effects-warmth-factor, 0.8) * 0.12))
    hue-rotate(calc(var(--visual-effects-audio-resonance, 0.7) * 8deg));
  
  // Environmental breathing
  // animation: visual-effects-environmental-breathing var(--visual-effects-breathing-cycle, 1s) ease-in-out infinite; // DISABLED: Caused global app bouncing
  
  // Performance optimization
  will-change: filter;
  
  // Environmental aura
  &::before {
    content: '';
    position: absolute;
    top: -15%;
    left: -15%;
    right: -15%;
    bottom: -15%;
    
    // Environmental visual effects field
    background: radial-gradient(
      ellipse at center,
      rgba(var(--dynamic-primary-rgb, 205, 214, 244), calc(var(--layered-shimmer-opacity, 0.05) * 3)) 0%,
      rgba(var(--layered-effect-rgb, 116, 199, 236), calc(var(--layered-shimmer-opacity, 0.05) * 2)) 30%,
      rgba(var(--dynamic-accent-rgb, 203, 166, 247), calc(var(--layered-shimmer-opacity, 0.05) * 1.5)) 60%,
      transparent 90%
    );
    
    // Environmental visual effects breathing
    // animation: visual-effects-environmental-aura calc(var(--visual-effects-breathing-cycle, 1s) * 2) ease-in-out infinite;
    
    // Performance optimization
    pointer-events: none;
    z-index: var(--visual-effects-depth-mid, 2);
    will-change: opacity, transform;
    contain: strict;
    mix-blend-mode: screen;
  }
  
  // Environmental interaction states
  &[data-environment-state="dormant"] {
    --environment-multiplier: 0.3;
    filter: 
      saturate(calc(1.0 + var(--visual-effects-emotional-saturation, 1) * 0.1))
      brightness(0.9);
  }
  
  &[data-environment-state="active"] {
    --environment-multiplier: 1.0;
  }
  
  &[data-environment-state="resonant"] {
    --environment-multiplier: 1.5;
    filter: 
      saturate(calc(1.0 + var(--visual-effects-emotional-saturation, 1) * 0.4))
      brightness(calc(1.0 + var(--visual-effects-warmth-factor, 0.8) * 0.2))
      hue-rotate(calc(var(--visual-effects-audio-resonance, 0.7) * 15deg));
    
    // Enhanced resonant aura
    &::after {
      content: '';
      position: absolute;
      top: -25%;
      left: -25%;
      right: -25%;
      bottom: -25%;
      
      background: radial-gradient(
        circle at center,
        rgba(var(--audio-visualization-rgb, 116, 199, 236), calc(var(--visual-effects-glow-opacity, 0.1) * 2)) 0%,
        rgba(var(--dynamic-accent-rgb, 203, 166, 247), calc(var(--visual-effects-glow-opacity, 0.1) * 1.5)) 40%,
        transparent 80%
      );
      
      // animation: visual-effects-resonant-field calc(var(--visual-effects-breathing-cycle, 1s) * 1.5) ease-in-out infinite;
      pointer-events: none;
      z-index: calc(var(--visual-effects-depth-mid, 2) + 1);
      mix-blend-mode: screen;
    }
  }
}

// === ATMOSPHERIC KEYFRAMES ===

// Volumetric breathing animation
@keyframes volumetric-breathing {
  0% {
    filter: 
      saturate(calc(1.0 + var(--visual-effects-emotional-saturation, 1) * 0.2))
      brightness(calc(1.0 + var(--visual-effects-warmth-factor, 0.8) * 0.1));
  }
  
  50% {
    filter: 
      saturate(calc(1.0 + var(--visual-effects-emotional-saturation, 1) * 0.25))
      brightness(calc(1.0 + var(--visual-effects-warmth-factor, 0.8) * 0.13))
      hue-rotate(calc(var(--lighting-multiplier, 1) * 3deg));
  }
  
  100% {
    filter: 
      saturate(calc(1.0 + var(--visual-effects-emotional-saturation, 1) * 0.2))
      brightness(calc(1.0 + var(--visual-effects-warmth-factor, 0.8) * 0.1));
  }
}

// Light rays animation
@keyframes visual-effects-light-rays {
  0% {
    background-position: 0px 0px, 0px 0px;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.4);
  }
  
  25% {
    background-position: 50px 50px, 37px 37px;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.6);
  }
  
  50% {
    background-position: 100px 100px, 75px 75px;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.5);
  }
  
  75% {
    background-position: 150px 150px, 112px 112px;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.6);
  }
  
  100% {
    background-position: 200px 200px, 150px 150px;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.4);
  }
}

// Atmospheric glow animation
@keyframes organic-atmospheric-glow {
  0% {
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.5);
    transform: scale(1.0) rotate(0deg);
  }
  
  33% {
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.7);
    transform: scale(1.05) rotate(2deg);
  }
  
  66% {
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.6);
    transform: scale(0.95) rotate(-1deg);
  }
  
  100% {
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.5);
    transform: scale(1.0) rotate(0deg);
  }
}

// Particle float animation
@keyframes organic-particle-float {
  0% {
    background-position: 0px 0px, 0px 0px, 0px 0px, 0px 0px, 0px 0px, 0px 0px;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.5);
  }
  
  25% {
    background-position: 20px -10px, 30px -15px, 25px -12px, 37px -18px, 22px -11px, 27px -13px;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.7);
  }
  
  50% {
    background-position: 40px -20px, 60px -30px, 50px -25px, 75px -37px, 45px -22px, 55px -27px;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.6);
  }
  
  75% {
    background-position: 60px -30px, 90px -45px, 75px -37px, 112px -56px, 67px -33px, 82px -41px;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.7);
  }
  
  100% {
    background-position: 80px -40px, 120px -60px, 100px -50px, 150px -75px, 90px -45px, 110px -55px;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.5);
  }
}

// Fog breathing animation
@keyframes organic-fog-breathing {
  0% {
    filter: 
      saturate(calc(1.0 + var(--visual-effects-emotional-saturation, 1) * 0.1))
      brightness(calc(1.0 + var(--visual-effects-warmth-factor, 0.8) * 0.05));
  }
  
  50% {
    filter: 
      saturate(calc(1.0 + var(--visual-effects-emotional-saturation, 1) * 0.15))
      brightness(calc(1.0 + var(--visual-effects-warmth-factor, 0.8) * 0.08))
      hue-rotate(calc(var(--fog-multiplier, 1) * 2deg));
  }
  
  100% {
    filter: 
      saturate(calc(1.0 + var(--visual-effects-emotional-saturation, 1) * 0.1))
      brightness(calc(1.0 + var(--visual-effects-warmth-factor, 0.8) * 0.05));
  }
}

// Fog drift animation
@keyframes organic-fog-drift {
  0% {
    background-position: 0% 0%, 0% 0%;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.8);
  }
  
  25% {
    background-position: 25% 12%, 18% 25%;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 1.0);
  }
  
  50% {
    background-position: 50% 25%, 37% 50%;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.9);
  }
  
  75% {
    background-position: 75% 37%, 56% 75%;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 1.0);
  }
  
  100% {
    background-position: 100% 50%, 75% 100%;
    opacity: calc(var(--visual-effects-cinematic-intensity, 0.8) * 0.8);
  }
}

// Environmental breathing animation
@keyframes organic-environmental-breathing {
  0% {
    filter: 
      saturate(calc(1.0 + var(--visual-effects-emotional-saturation, 1) * 0.25))
      brightness(calc(1.0 + var(--visual-effects-warmth-factor, 0.8) * 0.12));
  }
  
  50% {
    filter: 
      saturate(calc(1.0 + var(--visual-effects-emotional-saturation, 1) * 0.3))
      brightness(calc(1.0 + var(--visual-effects-warmth-factor, 0.8) * 0.15))
      hue-rotate(calc(var(--environment-multiplier, 1) * 5deg));
  }
  
  100% {
    filter: 
      saturate(calc(1.0 + var(--visual-effects-emotional-saturation, 1) * 0.25))
      brightness(calc(1.0 + var(--visual-effects-warmth-factor, 0.8) * 0.12));
  }
}

// Environmental aura animation
@keyframes organic-environmental-aura {
  0% {
    opacity: calc(var(--layered-shimmer-opacity, 0.05) * 3);
    transform: scale(1.0);
  }
  
  50% {
    opacity: calc(var(--layered-shimmer-opacity, 0.05) * 5);
    transform: scale(1.03);
  }
  
  100% {
    opacity: calc(var(--layered-shimmer-opacity, 0.05) * 3);
    transform: scale(1.0);
  }
}

// Resonant field animation
@keyframes organic-resonant-field {
  0% {
    opacity: calc(var(--visual-effects-glow-opacity, 0.1) * 2);
    transform: scale(1.0) rotate(0deg);
  }
  
  50% {
    opacity: calc(var(--visual-effects-glow-opacity, 0.1) * 3);
    transform: scale(1.1) rotate(180deg);
  }
  
  100% {
    opacity: calc(var(--visual-effects-glow-opacity, 0.1) * 2);
    transform: scale(1.0) rotate(360deg);
  }
}

// === ACCESSIBILITY AND PERFORMANCE ===

// Reduced motion support
@media (prefers-reduced-motion: reduce) {
  .dynamic-volumetric-lighting,
  .dynamic-atmospheric-particles,
  .dynamic-atmospheric-fog,
  .dynamic-environmental-consciousness {
    animation: none !important;
    filter: none !important;
    
    &::before,
    &::after {
      animation: none !important;
      opacity: 0.1 !important;
    }
  }
}

// Performance optimization for low-end devices
@media (update: slow) {
  .dynamic-atmospheric-particles {
    &::before,
    &::after {
      animation-duration: calc(var(--visual-effects-breathing-cycle, 1s) * 16) !important;
      will-change: auto !important;
    }
  }
  
  .dynamic-volumetric-lighting {
    &::before {
      background-size: 400px 400px, 300px 300px !important;
    }
  }
}

// Debug mode for atmospheric systems
:root.organic-debug {
  .dynamic-volumetric-lighting {
    outline: 2px dashed rgba(var(--sn-musical-harmony-analogous-warm-rgb), 0.8) !important;
    
    &::after {
      content: '💡 LIGHTING';
      position: absolute;
      top: -35px;
      left: 0;
      font-size: 10px;
      color: rgb(var(--sn-musical-harmony-analogous-warm-rgb));
      background: rgba(var(--spice-rgb-base), 0.9);
      padding: 2px 4px;
      border-radius: 2px;
      pointer-events: none;
      z-index: 9999;
    }
  }
  
  .dynamic-atmospheric-particles {
    outline: 1px dashed rgba(var(--sn-musical-harmony-primary-rgb), 0.5) !important;
    
    &::after {
      content: '✨ PARTICLES';
      position: absolute;
      top: -35px;
      right: 0;
      font-size: 10px;
      color: rgb(var(--sn-musical-harmony-primary-rgb));
      background: rgba(var(--spice-rgb-base), 0.9);
      padding: 2px 4px;
      border-radius: 2px;
      pointer-events: none;
      z-index: 9999;
    }
  }
  
  .dynamic-atmospheric-fog {
    outline: 1px dashed rgba(var(--sn-musical-harmony-triadic-muted-rgb), 0.8) !important;
    
    &::after {
      content: '🌫️ FOG';
      position: absolute;
      bottom: -35px;
      left: 0;
      font-size: 10px;
      color: rgb(var(--sn-musical-harmony-triadic-muted-rgb));
      background: rgba(var(--spice-rgb-base), 0.9);
      padding: 2px 4px;
      border-radius: 2px;
      pointer-events: none;
      z-index: 9999;
    }
  }
}

// ==============================================
// Legacy Compatibility Aliases
// ==============================================
// Ensures backward compatibility during transition

// Environmental consciousness → visual effects
.dynamic-environmental-consciousness {
  @extend .dynamic-environmental-visual-effects !optional;
}

// Light ray keyframes (alias for legacy compatibility)
@keyframes organic-light-rays {
  0% { opacity: 0; transform: translateY(100px); }
  50% { opacity: 0.5; }
  100% { opacity: 0; transform: translateY(-100px); }
}