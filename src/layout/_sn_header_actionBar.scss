/* ═══════════════════════════════════════════════════════════════════════════════*/
/* 🌟 YEAR 3000 HEADER VISUAL EFFECTS*/
/* Technology that synchronizes with the music's dynamic response*/
/* ═══════════════════════════════════════════════════════════════════════════════*/

@use "../core/mixins" as *;

/* Year 3000 Header Visual Variables (Dynamic Beauty)*/
:root {
  /* === DYNAMIC VISUAL CONTROL ===*/ /* Connected to main visual-effects*/ /* Gentle animation*/
  --header-musical-response: 0.6; /* How much the header responds to musical energy*/

  /* === ETHEREAL HEADER DYNAMICS ===*/
  --header-transition: calc(var(--choreography-harmony-sync, 0.8s) * 0.7)
    var(--sn-anim-easing-organic); /* Smooth, alive motion*/
  --header-cosmic-depth: calc(
    var(--cosmic-depth-layers, 80px) * 0.4
  ); /* Subtle 3D presence*/
  --header-cosmic-blur: calc(
    var(--cosmic-blur-poetry, 12px) * 0.8
  ); /* Dreamlike softness*/

  /* === MUSICAL COLOR INTERFACE (Connected to Dynamic Elegance) ===*/
  --header-interface-glow: rgba(
    var(--sn-accent-rgb, var(--spice-rgb-accent)),
    calc(var(--ethereal-glow-base, 0.2) * 0.4)
  );

  /* === DEFAULT INTERFACE TOKENS – ensure graceful fallback before JS initializes === */
  --header-interface-intensity: 0.8; /* 0 → off, 1 → full */
  --header-interface-animation-rate: 8s;
  --header-interface-primary: var(--sn-color-accent-hex, var(--spice-accent));
  --header-interface-secondary: var(--sn-color-accent-hex, var(--spice-subtext));
  --header-interface-accent: var(--sn-color-accent-hex, var(--spice-accent));
  
  /* === YEAR 3000 VISUAL EFFECTS VARIABLES === */
  --header-visual-effects-flow-speed: calc(var(--header-interface-animation-rate) * 0.8);
  --header-visual-effects-energy: 0.5; /* Updated by MusicSyncService */
  --header-visual-effects-harmony: 0deg; /* Hue rotation based on musical harmony */
  --header-visual-effects-depth: 1; /* Z-depth visual effects multiplier */
}

/* ═══════════════════════════════════════════════════════════════════════════════*/
/* 🚫 SEARCH EXCLUSION GUARD - Header Visual Effects DISABLED in Search*/
/* ═══════════════════════════════════════════════════════════════════════════════*/

/* Only apply visual effects OUTSIDE of search pages*/
body:not(:has(.main-searchPage-content)) {
  /* ═══════════════════════════════════════════════════════════════════════════════*/
  /* 🎯 NEXUS ACTION BAR VISUAL EFFECTS*/
  /* Header that animates and pulses with musical energy*/
  /* ═══════════════════════════════════════════════════════════════════════════════*/

  .main-actionBarBackground-background {
    position: relative;
    transition: all var(--header-transition);

    /* === DYNAMIC VISUAL PRESENCE ===*/
    &::before {
      content: "";
      position: absolute;
      top: -16px;
      left: -16px;
      right: -16px;
      bottom: -16px;
      z-index: -1;

      /* Dynamic visual effects inspired by moodboard*/
      background:
        // Primary interface energy
        radial-gradient(
          ellipse 400% 120% at 25% 50%,
          var(--header-interface-primary) 0%,
          transparent 45%
        ),
        /* Secondary harmonic flow*/
        radial-gradient(
            ellipse 300% 100% at 75% 50%,
            var(--header-interface-secondary) 0%,
            transparent 40%
          ),
        /* Accent energy shimmer*/
        linear-gradient(
            90deg,
            var(--header-interface-accent) 0%,
            transparent 25%,
            var(--header-interface-glow) 60%,
            transparent 100%
          );

      border-radius: 20px 28px 24px 32px; /* Organic, flowing shape*/
      filter: blur(var(--header-cosmic-blur))
        saturate(calc(var(--cosmic-saturation, 1.4) * 0.9))
        brightness(calc(1 + 0.08 * var(--header-interface-intensity)));

      /* Year 3000 Visual Effects - Internal energy flow synchronized with music */
      animation: header-dynamic-visual-effects var(--header-visual-effects-flow-speed)
        ease-in-out infinite;

      opacity: calc(var(--header-interface-intensity) * 0.6);
    }

    /* === ENHANCED INTERACTION VISUAL EFFECTS ===*/
    &:hover {
      &::before {
        opacity: calc(var(--header-interface-intensity) * 0.9);
        filter: blur(calc(var(--header-cosmic-blur) * 1.1))
          saturate(calc(var(--cosmic-saturation, 1.4) * 1.1))
          brightness(calc(1 + 0.15 * var(--header-interface-intensity)));
      }
    }

    /* === CONTENT PRESERVATION ===*/
    .main-actionBar-ActionBar {
      position: relative;
      z-index: 2;
      transition: all var(--header-transition);

      /* Gentle enhancement that supports content*/
      &:hover {
        filter: brightness(calc(1 + 0.05 * var(--header-interface-intensity)))
          saturate(calc(1 + 0.1 * var(--header-interface-intensity)));
      }
    }
  }

  /* ═══════════════════════════════════════════════════════════════════════════════*/
  /* 🎭 NEXUS ENTITY HEADER WITH DYNAMIC VISUALS*/
  /* Album/playlist headers that honor content while adding visual effects*/
  /* ═══════════════════════════════════════════════════════════════════════════════*/

  .main-entityHeader-container {
    position: relative;
    transition: all var(--header-transition);

    /* === DYNAMIC VISUAL BACKGROUND ===*/
    &::before {
      content: "";
      position: absolute;
      top: -12px;
      left: -12px;
      right: -12px;
      bottom: -12px;
      z-index: -1;

      /* Dynamic interface that supports the content*/
      background: radial-gradient(
          ellipse 250% 120% at 40% 60%,
          var(--header-interface-primary) 0%,
          transparent 50%
        ),
        linear-gradient(
          120deg,
          var(--header-interface-secondary) 0%,
          transparent 35%,
          var(--header-interface-accent) 80%,
          transparent 100%
        );

      border-radius: 16px 20px 18px 22px;
      filter: blur(var(--header-cosmic-blur))
        saturate(calc(var(--cosmic-saturation, 1.4) * 0.8));

      /* Year 3000 Entity Visual Effects - Dynamic energy responding to musical harmony */
      animation: header-entity-visual-effects
        calc(var(--header-visual-effects-flow-speed) * 1.3) ease-in-out infinite;

      opacity: 0;
      transition: all 0.6s var(--sn-anim-easing-organic);
    }

    &:hover::before {
      opacity: calc(var(--header-interface-intensity) * 0.7);
    }

    /* === ENHANCED TITLE WITH VISUAL EFFECTS ===*/
    .main-entityHeader-title {
      position: relative;
      transition: all var(--header-transition);

      &:hover {
        filter: drop-shadow(0 0 8px var(--header-interface-primary))
          drop-shadow(0 0 16px var(--header-interface-accent));
        transform: perspective(var(--header-cosmic-depth)) translateZ(4px);
      }

      h1 {
        font-weight: 700 !important;
        letter-spacing: -0.01em;
        line-height: 1.2;

        /* Subtle text enhancement*/
        text-shadow: 0 0 20px
          rgba(
            var(--sn-accent-rgb, var(--spice-rgb-accent)),
            calc(var(--header-interface-intensity) * 0.2)
          );
      }
    }
  }

  /* ═══════════════════════════════════════════════════════════════════════════════*/
  /* 🖼️ ALBUM ART VISUAL PRESENCE MODE*/
  /* Respect album art while adding subtle visual effects*/
  /* ═══════════════════════════════════════════════════════════════════════════════*/

  .main-entityHeader-imageContainer {
    position: relative;
    transition: all var(--header-transition);

    /* === DYNAMIC ENERGY RING (Subtle) ===*/
    &::before {
      content: "";
      position: absolute;
      top: -8px;
      left: -8px;
      right: -8px;
      bottom: -8px;
      z-index: -1;

      /* Dynamic ring that enhances without competing*/
      background: conic-gradient(
        from 0deg,
        var(--header-interface-accent) 0%,
        transparent 25%,
        var(--header-interface-primary) 50%,
        transparent 75%,
        var(--header-interface-secondary) 100%
      );

      border-radius: 50%;
      filter: blur(3px) saturate(calc(var(--cosmic-saturation, 1.4) * 0.7));

      /* Slow, dynamic rotation*/
      animation: dynamic-ring-rotation calc(var(--ethereal-flow-speed, 12s) * 2)
        linear infinite;

      opacity: 0;
      transition: all 0.5s ease;
    }

    &:hover::before {
      opacity: calc(var(--header-interface-intensity) * 0.5);
    }

    /* === ALBUM IMAGE PRESERVATION WITH VISUAL EFFECTS ===*/
    .main-entityHeader-image,
    .main-image-image {
      border-radius: 12px !important;
      transition: all var(--header-transition);

      /* Preserve image quality while adding visual effects*/
      box-shadow: 0 6px 24px
          rgba(var(--sn-oklab-processed-dynamic-shadow-rgb), 0.3),
        0 0 40px
          rgba(
            var(--sn-accent-rgb, var(--spice-rgb-accent)),
            calc(var(--header-interface-intensity) * 0.1)
          );

      &:hover {
        transform: scale(1.03) perspective(var(--header-cosmic-depth))
          rotateY(2deg) rotateX(1deg);
        box-shadow: 0 12px 40px
            rgba(var(--sn-oklab-processed-dynamic-shadow-rgb), 0.4),
          0 0 60px
            rgba(
              var(--sn-accent-rgb, 202, 158, 230),
              calc(var(--header-interface-intensity) * 0.2)
            ),
          0 0 100px
            rgba(
              var(--sn-accent-rgb, 140, 170, 238),
              calc(var(--header-interface-intensity) * 0.1)
            );
        -webkit-transform: scale(1.03) perspective(var(--header-cosmic-depth));
        -moz-transform: scale(1.03) perspective(var(--header-cosmic-depth));
        -ms-transform: scale(1.03) perspective(var(--header-cosmic-depth));
        -o-transform: scale(1.03) perspective(var(--header-cosmic-depth));
      }
    }
  }
} /* End of non-search body selector*/

/* ═══════════════════════════════════════════════════════════════════════════════*/
/* 🚫 SEARCH AREAS - Complete Respect Mode*/
/* ═══════════════════════════════════════════════════════════════════════════════*/

.main-searchPage-content {
  .main-actionBarBackground-background,
  .main-entityHeader-container {
    /* Preserve search functionality*/
    &::before,
    &::after {
      opacity: 0.05 !important; /* Minimal presence in search*/
    }

    animation-duration: 30s !important; /* Much slower if any*/
  }
}

/* ═══════════════════════════════════════════════════════════════════════════════*/
/* 🎬 VISUAL EFFECTS ANIMATIONS*/
/* Movements that feel dynamic and musically connected*/
/* ═══════════════════════════════════════════════════════════════════════════════*/

/* Year 3000 Visual Effects Animations - Internal energy flow without layout disruption */

@keyframes header-dynamic-visual-effects {
  0%, 100% {
    filter: blur(var(--header-cosmic-blur))
      saturate(calc(var(--cosmic-saturation, 1.4) * (0.9 + var(--header-visual-effects-energy) * 0.1)))
      brightness(calc(1 + 0.08 * var(--header-interface-intensity) + var(--header-visual-effects-energy) * 0.05))
      hue-rotate(calc(var(--header-visual-effects-harmony) + 0deg))
      contrast(calc(1 + var(--header-visual-effects-energy) * 0.05));
    opacity: calc(var(--header-interface-intensity) * (0.6 + var(--header-visual-effects-energy) * 0.1));
  }
  25% {
    filter: blur(calc(var(--header-cosmic-blur) * (1.1 - var(--header-visual-effects-energy) * 0.05)))
      saturate(calc(var(--cosmic-saturation, 1.4) * (1.1 + var(--header-visual-effects-energy) * 0.2)))
      brightness(calc(1 + 0.12 * var(--header-interface-intensity) + var(--header-visual-effects-energy) * 0.08))
      hue-rotate(calc(var(--header-visual-effects-harmony) + 8deg))
      contrast(calc(1.05 + var(--header-visual-effects-energy) * 0.1));
    opacity: calc(var(--header-interface-intensity) * (0.75 + var(--header-visual-effects-energy) * 0.15));
  }
  50% {
    filter: blur(calc(var(--header-cosmic-blur) * (0.9 + var(--header-visual-effects-energy) * 0.1)))
      saturate(calc(var(--cosmic-saturation, 1.4) * (1.0 + var(--header-visual-effects-energy) * 0.3)))
      brightness(calc(1 + 0.15 * var(--header-interface-intensity) + var(--header-visual-effects-energy) * 0.12))
      hue-rotate(calc(var(--header-visual-effects-harmony) + 15deg))
      contrast(calc(1.08 + var(--header-visual-effects-energy) * 0.15));
    opacity: calc(var(--header-interface-intensity) * (0.8 + var(--header-visual-effects-energy) * 0.2));
  }
  75% {
    filter: blur(calc(var(--header-cosmic-blur) * (1.05 - var(--header-visual-effects-energy) * 0.03)))
      saturate(calc(var(--cosmic-saturation, 1.4) * (0.95 + var(--header-visual-effects-energy) * 0.15)))
      brightness(calc(1 + 0.10 * var(--header-interface-intensity) + var(--header-visual-effects-energy) * 0.06))
      hue-rotate(calc(var(--header-visual-effects-harmony) + -5deg))
      contrast(calc(1.03 + var(--header-visual-effects-energy) * 0.08));
    opacity: calc(var(--header-interface-intensity) * (0.7 + var(--header-visual-effects-energy) * 0.12));
  }
}

@keyframes header-entity-visual-effects {
  0%, 100% {
    filter: blur(var(--header-cosmic-blur))
      saturate(calc(var(--cosmic-saturation, 1.4) * (0.8 + var(--header-visual-effects-energy) * 0.1)))
      brightness(calc(1 + var(--header-visual-effects-energy) * 0.03))
      hue-rotate(calc(var(--header-visual-effects-harmony) + 0deg));
    background-position: 
      calc(0% + var(--header-visual-effects-energy) * 5%) 50%, 
      calc(100% - var(--header-visual-effects-energy) * 5%) 50%, 
      0% 0%;
  }
  33% {
    filter: blur(calc(var(--header-cosmic-blur) * (0.95 + var(--header-visual-effects-energy) * 0.05)))
      saturate(calc(var(--cosmic-saturation, 1.4) * (0.9 + var(--header-visual-effects-energy) * 0.2)))
      brightness(calc(1.03 + var(--header-visual-effects-energy) * 0.05))
      hue-rotate(calc(var(--header-visual-effects-harmony) + 10deg));
    background-position: 
      calc(20% + var(--header-visual-effects-energy) * 10%) calc(40% + var(--header-visual-effects-energy) * 5%), 
      calc(80% - var(--header-visual-effects-energy) * 10%) calc(60% - var(--header-visual-effects-energy) * 5%), 
      calc(15% + var(--header-visual-effects-energy) * 8%) calc(85% - var(--header-visual-effects-energy) * 8%);
  }
  66% {
    filter: blur(calc(var(--header-cosmic-blur) * (1.1 - var(--header-visual-effects-energy) * 0.05)))
      saturate(calc(var(--cosmic-saturation, 1.4) * (0.85 + var(--header-visual-effects-energy) * 0.15)))
      brightness(calc(1.05 + var(--header-visual-effects-energy) * 0.08))
      hue-rotate(calc(var(--header-visual-effects-harmony) + -8deg));
    background-position: 
      calc(40% + var(--header-visual-effects-energy) * 15%) calc(30% + var(--header-visual-effects-energy) * 10%), 
      calc(60% - var(--header-visual-effects-energy) * 15%) calc(70% - var(--header-visual-effects-energy) * 10%), 
      calc(30% + var(--header-visual-effects-energy) * 12%) calc(70% - var(--header-visual-effects-energy) * 12%);
  }
}

@keyframes dynamic-ring-rotation {
  0% {
    transform: rotate(0deg) scale(1.02);
  }
  50% {
    transform: rotate(180deg) scale(1.04);
  }
  100% {
    transform: rotate(360deg) scale(1.02);
  }
}

/* ═══════════════════════════════════════════════════════════════════════════════*/
/* ♿ ACCESSIBILITY & PERFORMANCE WITH VISUAL EFFECTS*/
/* ═══════════════════════════════════════════════════════════════════════════════*/

@media (prefers-reduced-motion: reduce) {
  :root { /* Keep gentle visual effects*/ /* Much slower animation*/
  }

  * {
    animation-duration: 30s !important; /* Slow, calm motion*/
  }
}

@media (max-width: 768px) {
  :root { /* Reduce for mobile*/
    --header-cosmic-blur: 6px;
    --header-cosmic-depth: 30px;
  }
}

@media (prefers-contrast: high) {
  :root { /* More visible for accessibility*/
  }
}

/* ==============================================
// Legacy Compatibility Aliases
// ==============================================
// Ensures backward compatibility during transition */

/* CSS Variable aliases for soul → interface */
:root {
  --header-soul-intensity: var(--header-interface-intensity);
  --header-soul-breath-rate: var(--header-interface-animation-rate);
  --header-soul-primary: var(--header-interface-primary);
  --header-soul-secondary: var(--header-interface-secondary);
  --header-soul-accent: var(--header-interface-accent);
  --header-soul-whisper: var(--header-interface-glow);
}

/* Keyframe aliases for legacy animation names */
@keyframes header-cosmic-pulse {
  0%, 100% {
    filter: blur(var(--header-cosmic-blur))
      saturate(calc(var(--cosmic-saturation, 1.4) * (0.9 + var(--header-visual-effects-energy) * 0.1)))
      brightness(calc(1 + 0.08 * var(--header-interface-intensity) + var(--header-visual-effects-energy) * 0.05))
      hue-rotate(calc(var(--header-visual-effects-harmony) + 0deg))
      contrast(calc(1 + var(--header-visual-effects-energy) * 0.05));
    opacity: calc(var(--header-interface-intensity) * (0.6 + var(--header-visual-effects-energy) * 0.1));
  }
  25% {
    filter: blur(calc(var(--header-cosmic-blur) * (1.1 - var(--header-visual-effects-energy) * 0.05)))
      saturate(calc(var(--cosmic-saturation, 1.4) * (1.1 + var(--header-visual-effects-energy) * 0.2)))
      brightness(calc(1 + 0.12 * var(--header-interface-intensity) + var(--header-visual-effects-energy) * 0.08))
      hue-rotate(calc(var(--header-visual-effects-harmony) + 8deg))
      contrast(calc(1.05 + var(--header-visual-effects-energy) * 0.1));
    opacity: calc(var(--header-interface-intensity) * (0.75 + var(--header-visual-effects-energy) * 0.15));
  }
  50% {
    filter: blur(calc(var(--header-cosmic-blur) * (0.9 + var(--header-visual-effects-energy) * 0.1)))
      saturate(calc(var(--cosmic-saturation, 1.4) * (1.0 + var(--header-visual-effects-energy) * 0.3)))
      brightness(calc(1 + 0.15 * var(--header-interface-intensity) + var(--header-visual-effects-energy) * 0.12))
      hue-rotate(calc(var(--header-visual-effects-harmony) + 15deg))
      contrast(calc(1.08 + var(--header-visual-effects-energy) * 0.15));
    opacity: calc(var(--header-interface-intensity) * (0.8 + var(--header-visual-effects-energy) * 0.2));
  }
  75% {
    filter: blur(calc(var(--header-cosmic-blur) * (1.05 - var(--header-visual-effects-energy) * 0.03)))
      saturate(calc(var(--cosmic-saturation, 1.4) * (0.95 + var(--header-visual-effects-energy) * 0.15)))
      brightness(calc(1 + 0.10 * var(--header-interface-intensity) + var(--header-visual-effects-energy) * 0.06))
      hue-rotate(calc(var(--header-visual-effects-harmony) + -5deg))
      contrast(calc(1.03 + var(--header-visual-effects-energy) * 0.08));
    opacity: calc(var(--header-interface-intensity) * (0.7 + var(--header-visual-effects-energy) * 0.12));
  }
}

@keyframes header-entity-pulse {
  0%, 100% {
    filter: blur(var(--header-cosmic-blur))
      saturate(calc(var(--cosmic-saturation, 1.4) * (0.8 + var(--header-visual-effects-energy) * 0.1)))
      brightness(calc(1 + var(--header-visual-effects-energy) * 0.03))
      hue-rotate(calc(var(--header-visual-effects-harmony) + 0deg));
    background-position: 
      calc(0% + var(--header-visual-effects-energy) * 5%) 50%, 
      calc(100% - var(--header-visual-effects-energy) * 5%) 50%, 
      0% 0%;
  }
  33% {
    filter: blur(calc(var(--header-cosmic-blur) * (0.95 + var(--header-visual-effects-energy) * 0.05)))
      saturate(calc(var(--cosmic-saturation, 1.4) * (0.9 + var(--header-visual-effects-energy) * 0.2)))
      brightness(calc(1.03 + var(--header-visual-effects-energy) * 0.05))
      hue-rotate(calc(var(--header-visual-effects-harmony) + 10deg));
    background-position: 
      calc(20% + var(--header-visual-effects-energy) * 10%) calc(40% + var(--header-visual-effects-energy) * 5%), 
      calc(80% - var(--header-visual-effects-energy) * 10%) calc(60% - var(--header-visual-effects-energy) * 5%), 
      calc(15% + var(--header-visual-effects-energy) * 8%) calc(85% - var(--header-visual-effects-energy) * 8%);
  }
  66% {
    filter: blur(calc(var(--header-cosmic-blur) * (1.1 - var(--header-visual-effects-energy) * 0.05)))
      saturate(calc(var(--cosmic-saturation, 1.4) * (0.85 + var(--header-visual-effects-energy) * 0.15)))
      brightness(calc(1.05 + var(--header-visual-effects-energy) * 0.08))
      hue-rotate(calc(var(--header-visual-effects-harmony) + -8deg));
    background-position: 
      calc(40% + var(--header-visual-effects-energy) * 15%) calc(30% + var(--header-visual-effects-energy) * 10%), 
      calc(60% - var(--header-visual-effects-energy) * 15%) calc(70% - var(--header-visual-effects-energy) * 10%), 
      calc(30% + var(--header-visual-effects-energy) * 12%) calc(70% - var(--header-visual-effects-energy) * 12%);
  }
}

@keyframes cosmic-ring-rotation {
  0% {
    transform: rotate(0deg) scale(1.02);
  }
  50% {
    transform: rotate(180deg) scale(1.04);
  }
  100% {
    transform: rotate(360deg) scale(1.02);
  }
}
