/* ████████████████████████████████████████████████████████████████████████████████*/
/* SIDEBAR INTERACTIVE SYSTEM MODULE*/
/* Advanced Interactive Effects, Meditation Modes & Visual Effects Field*/
/* ████████████████████████████████████████████████████████████████████████████████*/
/**/
/* This module contains advanced sidebar effects that complement the base*/
/* SidebarVisualEffectsSystem, including:*/
/* - Atmospheric effects (hue shifting, saturation control, vibration)*/
/* - Advanced visual effects field coordination*/
/**/
/**/
/* Dependencies:*/
/* - Base sidebar visual effects system (_sidebar_visual_effects.scss)*/
/* - Year 3000 gradient variables (--sn-gradient-*-rgb)*/
/* - Spicetify theme variables (--spice-rgb-*)*/
/**/
/* ████████████████████████████████████████████████████████████████████████████████*/

@use "../core/_mixins" as *;
@use "../core/_design_tokens" as *;

@include left-sidebar-root {
  nav[aria-label="Main"] a,
  .main-yourLibraryX-header a, /* Links in library header*/
  div[data-testid="left-sidebar-footer"] a, /* Links in sidebar footer*/
  a.link-subtle.main-navBar-navBarLink {
    /* Common class for Home, Search etc.*/
    position: relative;
    display: flex; /* Use flex for better alignment of icons and text*/
    align-items: center;
    padding: 8px 24px; /* Standard Spicetify padding*/
    margin: 2px 0;
    border-radius: 6px;
    opacity: var(--sn-nav-item-base-opacity);
    transform: scale(var(--sn-nav-item-transform-scale));
    transition: opacity var(--sn-nav-item-transition-duration) ease,
      background-color var(--sn-nav-item-transition-duration) ease,
      transform var(--sn-nav-item-transition-duration)
        var(--sn-anim-easing-dynamic),
      box-shadow var(--sn-nav-item-transition-duration) ease;

    /* Quantum glow effect via pseudo-element*/
    &::before {
      content: "";
      position: absolute;
      inset: -1px; /* Slightly larger than the element*/
      border-radius: inherit;
      background: radial-gradient(
        ellipse at center,
        rgba(
            var(--sn-nav-item-glow-color-rgb),
            calc(var(--sn-nav-item-glow-intensity) * 0.6)
          )
          0%,
        rgba(
            var(--sn-nav-item-glow-color-rgb),
            calc(var(--sn-nav-item-glow-intensity) * 0.2)
          )
          40%,
        transparent 70%
      );
      opacity: 0;
      transition: opacity var(--sn-nav-item-transition-duration) ease;
      z-index: -1; /* Behind the element*/
    }

    /* Hover and active states*/
    &:hover,
    &:focus,
    &[aria-current="page"],
    &.main-navBar-navBarLinkActive {
      background-color: rgba(
        var(--sn-nav-item-glow-color-rgb),
        var(--sn-nav-item-hover-bg-opacity)
      );
      transform: scale(var(--sn-nav-item-transform-scale)) translateY(-0.5px); /* Slight lift*/
      box-shadow: 0 2px 8px -2px rgba(var(--sn-nav-item-glow-color-rgb), calc(var(
                --sn-nav-item-glow-intensity
              ) * 0.4));

      &::before {
        opacity: 1; /* Activate glow*/
      }

      /* Text glow enhancement for high-energy states*/
      .Type__TypeElement-sc-goliZz-0,
      span {
        text-shadow: 0 0 6px
          rgba(
            var(--sn-nav-text-energy-color-rgb),
            var(--sn-nav-text-energy-opacity)
          );
      }
    }

    /* Active/current page additional styling*/
    &[aria-current="page"],
    &.main-navBar-navBarLinkActive {
      background-color: rgba(
        var(--sn-nav-item-glow-color-rgb),
        var(--sn-nav-item-active-bg-opacity)
      );
      box-shadow: inset 0 1px 3px
          rgba(
            var(--sn-nav-item-glow-color-rgb),
            calc(var(--sn-nav-item-glow-intensity) * 0.3)
          ),
        0 2px 8px -2px rgba(var(--sn-nav-item-glow-color-rgb), calc(var(
                  --sn-nav-item-glow-intensity
                ) * 0.5));
    }
  }
}

/* ████████████████████████████████████████████████████████████████████████████████*/
/* DIGITAL MEDITATION STATE & BIOMETRIC FEEDBACK*/
/* ████████████████████████████████████████████████████████████████████████████████*/

/* Sidebar Digital Meditation State*/
@include left-sidebar-root {
  /* Apply desaturation and slowdown when --sn-sidebar-meditation-desaturation > 0*/
  /* This requires careful application to not break other filter effects.*/
  /* We might need to adjust how filters are composed in the ::before/::after layers.*/
  /* For now, a simple approach targeting the main layers' filter property:*/
  &.sn-digital-meditation {
    /* This class will be added by JS*/
    .sn-visual-effects-layer, /* Target the pseudo-elements if they have distinct classes*/
    .sn-neural-flow-layer,
    .sn-quantum-foam-layer,
    &::before, /* If layers are directly on ::before*/
    &::after {
      /* and ::after*/
      filter: blur(var(--sn-sidebar-blur-intensity, 3px))
        saturate(
          calc(
            var(--sn-gradient-saturation) *
              (1 - var(--sn-sidebar-meditation-desaturation))
          )
        )
        brightness(var(--sn-gradient-brightness))
        contrast(var(--sn-gradient-contrast));
      animation-duration: calc(
        var(--original-animation-duration, 20s) /
          var(--sn-sidebar-meditation-slowdown)
      );
      /* Need to ensure other animation properties also respect this slowdown if not using a single duration property.*/
    }
    /* Reduce animation speed for specific animations*/
    /* This is tricky without a global animation speed control on the parent.*/
    /* Individual animation-duration properties would need to be targeted or vars used.*/
    /* For example, if --sn-neural-flow-speed is used by an animation:*/
    /* --sn-neural-flow-speed: calc(var(--original-neural-flow-speed, 20s) / var(--sn-sidebar-meditation-slowdown));*/
  }
}

/* Item Energy Absorption Feedback (applied to nav items by JS)*/
.main-yourLibraryX-navLink,
.main-yourLibraryX-listItem,
nav[aria-label="Main"] ul li a {
  &.sn-absorbing-energy {
    transition: transform 0.1s var(--sn-anim-easing-bounce-playful); /* Quick, bouncy feel*/
    transform: scale(var(--sn-item-energy-absorption-scale));
    /* Potentially add a subtle glow change too*/
    box-shadow: 0 0 calc(5px + 8px * var(--sn-nav-item-glow-intensity))
        rgba(
          var(--sn-nav-item-glow-color-rgb),
          calc(var(--sn-nav-item-glow-intensity) * 0.3)
        ),
      inset 0 0 3px
        rgba(
          var(--sn-nav-item-glow-color-rgb),
          calc(var(--sn-nav-item-glow-intensity) * 0.15)
        );
  }
}

/* ████████████████████████████████████████████████████████████████████████████████*/
/* ATMOSPHERIC EFFECTS & QUANTUM ENTANGLEMENT*/
/* ████████████████████████████████████████████████████████████████████████████████*/

@include left-sidebar-root {
  /* Or whichever element holds the main sidebar background layers*/
  /* Apply atmospheric hue shift and saturation to the whole sidebar or specific layers*/
  /* This example applies it to the main sidebar container. Be careful with specificity.*/
  filter: hue-rotate(var(--sn-sidebar-atmosphere-hue-shift, 0deg))
    saturate(var(--sn-sidebar-atmosphere-saturation-factor, 1));
  transition: filter 1.5s ease-in-out; /* Smooth transition for atmospheric changes*/

  /* Entanglement: Add a pseudo-element for the color bleed effect*/
  &::after {
    /* Or another pseudo-element if ::after is already in use*/
    content: "";
    position: absolute;
    inset: 0;
    background-color: rgba(
      var(--sn-sidebar-entanglement-color-rgb, 48, 52, 70),
      var(--sn-sidebar-entanglement-intensity, 0)
    );
    mix-blend-mode: color-dodge; /* Or other blend modes like soft-light, overlay*/
    pointer-events: none;
    z-index: 0; /* Ensure it's above base background but below content if needed*/
    transition: background-color 1.2s ease-in-out;
    opacity: var(
      --sn-sidebar-entanglement-intensity,
      0
    ); /* Control via intensity var*/
  }

  /* Vibration Effect (applied to a background layer, e.g., ::before or a dedicated div)*/
  /* Assuming .sn-sidebar-vibration-layer is a child or pseudo of .Root__nav-bar*/
  .sn-sidebar-vibration-layer,
  &::before {
    /* Example targets*/
    /* If var is 0, no animation. If > 0, animation runs.*/
    /* JS could add/remove a class to control animation play state too.*/
    animation-name: sn-sidebar-vibrate;
    animation-duration: 0.3s;
    animation-iteration-count: infinite;
    animation-timing-function: linear;
    animation-play-state: var(--_sidebar-vibration-play-state, paused);
    /* Helper variable to control play state based on intensity*/
  }
}

/* ████████████████████████████████████████████████████████████████████████████████*/
/* PREDICTIVE MATERIALIZATION SYSTEM EFFECTS*/
/* ████████████████████████████████████████████████████████████████████████████████*/

/* Styles for a generic predictive echo item (applied by JS)*/
.sn-predictive-echo-item {
  opacity: var(--sn-predictive-echo-opacity, 0);
  transform: scale(var(--sn-predictive-echo-scale, 1));
  transition: opacity 0.5s ease-out, transform 0.5s ease-out;
  /* Add a subtle shimmer or pulse if desired*/
  // Phase 8.5b: Use unified shimmer system (filter type for brightness/saturate effects)
  @include unified-shimmer($type: 'filter', $intensity: 'subtle');
  animation-duration: 3s;
}

/* Styles for a dimensional rift effect (conceptual, likely a pseudo-element on a target)*/
.sn-dimensional-rift-target {
  /* Example target class JS might add this to*/
  position: relative;
  overflow: visible; /* Allow pseudo-element to extend*/

  &::before {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 150px;
    height: 150px;
    border-radius: 50%;
    background: radial-gradient(
      circle,
      rgba(var(--sn-dimensional-rift-color-rgb), 0.8) 0%,
      rgba(var(--sn-dimensional-rift-color-rgb), 0.2) 40%,
      transparent 70%
    );
    transform: translate(-50%, -50%)
      scale(calc(0.5 + var(--sn-dimensional-rift-intensity, 0) * 0.6));
  }
}

/* ████████████████████████████████████████████████████████████████████████████████*/
/* TEMPORAL ECHO LAYER STYLING (from _sn_advanced_visual_effects.scss)*/
/* ████████████████████████████████████████████████████████████████████████████████*/
/* Note: Color harmony and music energy classes moved to consolidated section below */

@include left-sidebar-root {
  /* --- Temporal Echo Layer Styling ---*/
  /* This uses the --sn-sidebar-temporal-shift variable set by JS*/
  /* Applied to a pseudo-element if existing ones are not sufficient, or integrated into existing ones.*/
  /* Assuming ::after is available or one of the existing ::before/::after from Dimensional Nexus can be augmented.*/
  /* This example augments the ::after from Dimensional Nexus Phase 1 (Quantum Foam & Temporal Displacement)*/
  &::after {
    /* Keep existing Dimensional Nexus ::after styles (Quantum Foam, Temporal Displacement)*/
    /* Add new properties or modify existing ones related to the temporal echo*/
    transition: opacity 1s ease, filter 1s ease,
      transform var(--sn-sidebar-current-temporal-shift) ease-out; /* Added transform*/

    /* Example: Make the temporal echo more pronounced when shift is active*/
    /* The --sn-sidebar-temporal-shift is a duration, not direct opacity/blur value.*/
    /* JS sets this. We can use it to modify animation speed or other properties if needed.*/
    /* For a visual echo effect, we might need another variable from JS for opacity/blur of the echo itself.*/
    /* Let's assume --sn-sidebar-temporal-echo-opacity and --sn-sidebar-temporal-blur are set by JS if needed.*/
    opacity: calc(
      var(--sn-quantum-foam-opacity, 0.03) +
        var(--sn-sidebar-temporal-echo-opacity, 0)
    );
    filter: blur(var(--sn-sidebar-temporal-blur, 0px)); /* Add blur for echo*/
  }
}

/* ████████████████████████████████████████████████████████████████████████████████*/
/* ENHANCED NAVIGATION ITEMS WITH DIMENSIONAL EFFECTS*/
/* ████████████████████████████████████████████████████████████████████████████████*/

@include left-sidebar-root {
  /* Target general navigation links. Adapt selectors as needed.*/
  .main-navBar-navBarLink,
  .main-yourLibraryX-navLinkContainer a, /* For library items in grid/list view*/
  .main-rootlist-rootlistItem a, /* For playlist items in folders*/
  .main-playlistFolder-textLink {
    position: relative;
    transition: all 0.4s var(--sn-easing-explorer);
    padding: 8px 12px; /* Consistent padding*/
    margin: 2px 4px;
    border-radius: var(--border-radius, 6px);

    &::before {
      /* For bloom/glow effect*/
      content: "";
      position: absolute;
      inset: -2px;
      border-radius: inherit;
      background: radial-gradient(
        ellipse at center,
        rgba(
            var(--sn-accent-rgb, var(--spice-rgb-accent)),
            calc(var(--sn-sidebar-item-bloom-intensity) * 0.7)
          )
          0%,
        transparent 60%
      );
      opacity: 0;
      transition: opacity 0.4s var(--sn-easing-explorer);
      z-index: -1;
      transform: scale(0.95);
    }

    &:hover,
    &.main-navBar-navBarLinkActive,
    &[aria-current="page"] {
      background-color: rgba(
        var(--sn-accent-rgb, var(--spice-rgb-accent)),
        0.15
      );
      color: var(--spice-text);
      transform: translateY(-1px) scale(1.02);
      box-shadow: 0 3px 15px -5px rgba(var(--sn-accent-rgb, var(--spice-rgb-accent)), 0.3);

      &::before {
        /* Activate bloom*/
        opacity: 1;
        transform: scale(1);
      }
    }

    /* Energy-based text glow for high energy music*/
    .sn-music-high-energy & {
      .Type__TypeElement-sc-goliZz-0,
      span {
        text-shadow: 0 0 8px
          rgba(
            var(--sn-accent-rgb, var(--spice-rgb-accent)),
            calc(0.5 * var(--sn-sidebar-energy-glow-opacity))
          );
      }
    }
  }

  /* Specificity for Your Library items if different selectors are needed*/
  .main-yourLibraryX-listItem .main-useDropTarget-base {
    /* Common wrapper for library items*/
    transition: all 0.4s var(--sn-easing-explorer);
    border-radius: var(--border-radius, 4px);
    padding: 6px 8px;
    margin: 1px 4px;

    &:hover {
      background-color: rgba(
        var(--sn-accent-rgb, var(--spice-rgb-accent)),
        0.1
      );
      transform: scale(1.01);
      box-shadow: 0 2px 10px -4px rgba(var(--sn-accent-rgb, var(--spice-rgb-accent)), 0.25);
    } /* Closes &:hover*/

    /* Active library item*/
    &[aria-current="true"],
    .main-yourLibraryX-navLinkActive & {
      /* If parent has active class*/
      background-color: rgba(
        var(--sn-accent-rgb, var(--spice-rgb-accent)),
        0.15
      );
      // Phase 8.5b+: Use consolidated music-reactive-shadow mixin
      @include music-reactive-shadow($blur: 10px, $spread: -5px, $base-opacity: 0.3, $inset: true, $secondary: false);
    } /* Closes &[aria-current="true"] / .main-yourLibraryX-navLinkActive &*/
  } /* Closes .main-yourLibraryX-listItem .main-useDropTarget-base*/

  /* Musical DNA Visualization (Placeholder - requires JS to add specific classes like .sn-item-type-playlist)*/
  .sn-item-type-playlist::after {
    content: "\1F3A7"; /* 🎧 */
  }
  .sn-item-type-album::after {
    content: "\1F4BF"; /* 💿 */
  }
  .sn-item-type-artist::after {
    content: "\1F3A4"; /* 🎤 */
  }
  .sn-item-type-folder::after {
    content: "\1F4C1"; /* 📁 */
  }

  [class*="sn-item-type-"]::after {
    font-size: 0.8em;
    margin-left: 8px;
    opacity: 0.5;
  }
} /* Closes the .Root__nav-bar block for navigation item enhancements*/

/* ████████████████████████████████████████████████████████████████████████████████*/
/* ADVANCED ANIMATIONS & KEYFRAMES*/
/* ████████████████████████████████████████████████████████████████████████████████*/

/* Vibration Animation*/
@keyframes sn-sidebar-vibrate {
  0% {
    transform: translate(
      calc(var(--sn-sidebar-atmosphere-vibration-intensity, 0) * 0.2px),
      calc(var(--sn-sidebar-atmosphere-vibration-intensity, 0) * 0.2px)
    );
  }
  25% {
    transform: translate(
      calc(var(--sn-sidebar-atmosphere-vibration-intensity, 0) * -0.2px),
      calc(var(--sn-sidebar-atmosphere-vibration-intensity, 0) * 0.3px)
    );
  }
  50% {
    transform: translate(
      calc(var(--sn-sidebar-atmosphere-vibration-intensity, 0) * 0.3px),
      calc(var(--sn-sidebar-atmosphere-vibration-intensity, 0) * -0.2px)
    );
  }
  75% {
    transform: translate(
      calc(var(--sn-sidebar-atmosphere-vibration-intensity, 0) * -0.1px),
      calc(var(--sn-sidebar-atmosphere-vibration-intensity, 0) * -0.3px)
    );
  }
  100% {
    transform: translate(
      calc(var(--sn-sidebar-atmosphere-vibration-intensity, 0) * 0.2px),
      calc(var(--sn-sidebar-atmosphere-vibration-intensity, 0) * 0.2px)
    );
  }
}

/* Predictive Echo Shimmer*/
// REMOVED (Phase 8.5b): sn-echo-shimmer → consolidated into unified-shimmer($type: 'filter')

/* Dynamic Harmonic & Energy Responsive UI*/

:root {
  /* Base variables for Advanced Sidebar. These can be adjusted.*/
  --sn-sidebar-base-bg-opacity: 0.1;

  /* Default time-based shift, JS will update this with --sn-sidebar-temporal-shift*/
}

/* --- Color Harmony Mode Styling ---*/
/* Define a mixin for common color harmony mode background properties*/
@mixin color-harmony-background($primary-rgb, $secondary-rgb, $accent-rgb) {
    background: linear-gradient(
      170deg,
      rgba(
          $primary-rgb,
          calc(
            var(--sn-sidebar-base-bg-opacity) * 0.7 *
              var(--sn-sidebar-harmonic-intensity-multiplier)
          )
        )
        0%,
      rgba(
          $secondary-rgb,
          calc(
            var(--sn-sidebar-base-bg-opacity) * 0.5 *
              var(--sn-sidebar-harmonic-intensity-multiplier)
          )
        )
        40%,
      rgba(
          $accent-rgb,
          calc(
            var(--sn-sidebar-base-bg-opacity) * 0.8 *
              var(--sn-sidebar-harmonic-intensity-multiplier)
          )
        )
        100%
    );
    // Phase 8.5b+: Use consolidated music-reactive-shadow mixin
    @include music-reactive-shadow($blur: 80px, $spread: -20px, $base-opacity: 0.15, $inset: true, $secondary: true);
}

@include left-sidebar-root {
  /* Base transition for all dynamic effects*/
  transition: background-color 0.7s var(--sn-easing-explorer),
    box-shadow 0.7s var(--sn-easing-explorer),
    filter 0.7s var(--sn-easing-explorer);

  /* Apply backgrounds per color harmony mode (JS adds these classes)*/
  &.sn-color-harmony-analogous-flow {
    @include color-harmony-background(
      var(--sn-accent-rgb, "202,158,230"),
      var(--sn-accent-rgb, "186,187,241"),
      var(--sn-accent-rgb, "140,170,238")
    );
  }
  &.sn-color-harmony-triadic-scheme {
    /* Example: Use Primary, Accent, and a shifted Primary for Triadic relationship*/
    @include color-harmony-background(
      var(--sn-accent-rgb, "203,166,247"),
      /* Mauve as P1*/
      var(--sn-accent-rgb, "148,226,213"),
      /* Teal as P2 (derived from accent)*/
      var(--sn-accent-rgb, "245,194,231")
        /* Pink as P3 (derived from secondary)*/
    );
  }
  &.sn-color-harmony-complementary-contrast {
    /* Primary and Accent (often complementary)*/
    @include color-harmony-background(
      var(--sn-accent-rgb, "239,159,118"),
      /* Peach as P1*/
      var(--sn-accent-rgb, "137,180,250"),
      /* Blue as P2 (complement)*/
      var(--spice-rgb-surface1, "69,71,90") /* Neutral darker for depth*/
    );
  }
  /* Add more .sn-color-harmony-* classes as needed for other modes from COLOR_HARMONY_MODES*/
  &.sn-color-harmony-tetradic-cross {
    /* Example*/
    @include color-harmony-background(
      var(--spice-rgb-green),
      var(--spice-rgb-red),
      var(--spice-rgb-yellow)
    );
  }
  &.sn-color-harmony-split-complementary-spectrum {
    /* Example*/
    @include color-harmony-background(
      var(--spice-rgb-peach),
      var(--spice-rgb-sky),
      var(--spice-rgb-teal)
    );
  }
  &.sn-color-harmony-monochromatic-calm {
    /* Example*/
    @include color-harmony-background(
      var(--sn-accent-rgb), // Keep as RGB triplet for mixin compatibility
      var(--sn-accent-rgb),
      var(--sn-accent-rgb)
    );
    --sn-sidebar-base-bg-opacity: 0.2; /* More intense for monochromatic*/
  }

  /* --- Music Energy Styling ---*/
  /* (JS adds these classes: sn-music-low-energy, sn-music-mid-energy, sn-music-high-energy)*/
  &.sn-music-low-energy {
    filter: saturate(0.85) brightness(0.95);
    animation: sn-sidebar-pulse-slow 8s infinite ease-in-out alternate;
  }
  &.sn-music-mid-energy {
    filter: saturate(1) brightness(1);
    animation: sn-sidebar-pulse-mid 5s infinite ease-in-out alternate;
  }
  &.sn-music-high-energy {
    filter: saturate(1.15) brightness(1.05);
    animation: sn-sidebar-pulse-fast 3s infinite ease-in-out alternate;
  }

  /* Subtle pulsing animation for the sidebar background based on energy*/
  @keyframes sn-sidebar-pulse-slow {
    0%,
    100% {
      box-shadow: inset 0 0 70px -25px oklab-color('accent', calc(0.1 *
              var(--sn-sidebar-harmonic-intensity-multiplier) * 0.7));
    }
    50% {
      box-shadow: inset 0 0 80px -20px oklab-color('accent', calc(0.15 *
              var(--sn-sidebar-harmonic-intensity-multiplier) * 0.7));
    }
  }
  @keyframes sn-sidebar-pulse-mid {
    0%,
    100% {
      box-shadow: inset 0 0 80px -20px oklab-color('accent', calc(0.2 *
              var(--sn-sidebar-harmonic-intensity-multiplier)));
    }
    50% {
      box-shadow: inset 0 0 90px -15px oklab-color('accent', calc(0.25 *
              var(--sn-sidebar-harmonic-intensity-multiplier)));
    }
  }
  @keyframes sn-sidebar-pulse-fast {
    0%,
    100% {
      box-shadow: inset 0 0 90px -15px oklab-color('accent', calc(0.3 *
              var(--sn-sidebar-harmonic-intensity-multiplier) * 1.2));
    }
    50% {
      box-shadow: inset 0 0 100px -10px oklab-color('accent', calc(0.35 *
              var(--sn-sidebar-harmonic-intensity-multiplier) * 1.2));
    }
  }
}

@keyframes year3000-future-preview {
  0% {
    opacity: 0;
    transform: scale(0.95);
    filter: blur(2px);
  }
  50% {
    opacity: calc(var(--sn-kinetic-intensity, 1) * 0.2);
    transform: scale(1);
    filter: blur(1px);
  }
  100% {
    opacity: 0;
    transform: scale(1.05);
    filter: blur(0px);
  }
}

.sn-future-preview {
  animation: year3000-future-preview 2000ms ease-in-out;
  -webkit-animation: year3000-future-preview 2000ms ease-in-out;
}

/* === Digital Meditation Support (Phase 5) ===*/
.sn-digital-meditation {
  filter: grayscale(var(--sn-sidebar-meditation-desaturation))
          brightness(calc(1 - var(--sn-sidebar-meditation-desaturation) * 0.2));
  transition: filter calc(var(--sn-sidebar-meditation-slowdown) * 2000ms) ease-out;

  /* Slow down all sidebar animations during meditation*/
  * {
    animation-duration: calc(var(--sn-sidebar-meditation-slowdown, 1) * 1s) !important;
    transition-duration: calc(var(--sn-sidebar-meditation-slowdown, 1) * 400ms) !important;
  }

  /* Apply meditation blur effect to sidebar links*/
  .main-navBar-navBarLink {
    filter: blur(calc(var(--sn-sidebar-meditation-desaturation) * 2px));
    opacity: calc(1 - var(--sn-sidebar-meditation-desaturation) * 0.3);
  }

  /* Soften the sidebar background during meditation*/
  &::before {
    background: linear-gradient(
      180deg,
      rgba(var(--spice-rgb-sidebar, 48, 52, 70), calc(1 - var(--sn-sidebar-meditation-desaturation) * 0.5)) 0%,
      rgba(var(--spice-rgb-sidebar, 48, 52, 70), 1) 100%
    );
  }
}

/* === End Digital Meditation Support ===*/
