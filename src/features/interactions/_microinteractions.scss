// ████████████████████████████████████████████████████████████████████████████████
// YEAR 3000 MICROINTERACTIONS - Rhythmic Visual Effects in Every Touch
// Action Verbs: RIPPLE, BLOOM, REFRACT, HARMONIZE
// Every interaction pulses with the rhythm of the music
// ████████████████████████████████████████████████████████████████████████████████

@use "../../core/_mixins" as *;
@use "../animations/fluid_morphing" as *; // Phase 8: Year3000 fluid ripple feedback

// Note: Core interaction variables, keyframes, and utility classes moved to:
// - src/core/_interaction_mixins.scss (imported via _main.scss Layer 2)
// This eliminates ~200 lines of duplication across interaction files

// ══════════════════════════════════════════════════════════════════════════════
// MICROINTERACTION-SPECIFIC VARIABLES
// ══════════════════════════════════════════════════════════════════════════════

:root {
  // === LOCAL MICROINTERACTION VARIABLES ===
  // (Shared variables now in _interaction_mixins.scss)
  --micro-beat-intensity: var(--sn-beat-pulse-intensity, 0); // Local alias for beat intensity
  --micro-breathing-scale: 1; // Scale removed to eliminate bubble effects

  // === Cosmic Enhancement Variables (microinteraction-specific) ===
  --micro-glow-radius: calc(8px + (12px * var(--micro-beat-intensity)));
  --micro-scale-enhancement: calc(1 + (var(--micro-beat-intensity) * 0.02));
  --micro-hue-shift: calc(var(--sn-rhythm-phase, 0) * 1deg);
}

// ══════════════════════════════════════════════════════════════════════════════
// YEAR 3000 ENHANCED CARD MICROINTERACTIONS - Dynamic Touch Symphony
// ══════════════════════════════════════════════════════════════════════════════

// Enhanced main-card-card with YEAR 3000 rhythmic visual effects
.main-card-card,
.main-card-cardContainer {
  // Action Verb: OSCILLATE - Base animation with rhythm (scale removed)
  transform: translateZ(0);
  transition: transform var(--micro-medium) var(--sn-easing-explorer, ease-out);
  
  // Breathing removed - too many elements, creates visual chaos

  // Apply gradient ripple with beat sync
  @include gradient-ripple(
    rgba(var(--spice-rgb-accent), var(--feedback-moderate))
  );

  // Enhanced hover glow with rhythmic intensity
  @include gradient-glow(var(--sn-color-accent-hex), var(--feedback-subtle));

  // Add dynamic filter effects
  filter: hue-rotate(var(--micro-hue-shift))
    saturate(calc(1 + (var(--micro-beat-intensity) * 0.1)))
    brightness(calc(1 + (var(--micro-beat-intensity) * 0.05)));

  // Kinetic Verb: BLOOM - Enhanced hover with rhythm (scale removed)
  &:hover {
    transform: translateZ(0);
    box-shadow: 0 0 var(--micro-glow-radius)
      rgba(
        var(--sn-accent-rgb, var(--spice-rgb-accent)),
        var(--feedback-moderate)
      );
  }

  // Enhanced play button interaction with dynamic visual effects
  .main-card-PlayButtonContainer,
  .main-playButton-PlayButton {
    @include interaction-feedback(
      calc(1.05 + (var(--micro-beat-intensity) * 0.03)),
      true
    );

    // Beat-responsive ripple enhancement
    --ripple-color: var(--spice-accent);
    --ripple-intensity: var(--feedback-prominent);

    // Dynamic glow pulse
    box-shadow: 0 0 calc(var(--micro-glow-radius) * 0.8)
      rgba(
        var(--spice-rgb-accent),
        calc(var(--feedback-moderate) * var(--micro-beat-intensity))
      );
  }
}

// PHASE 4.1: Playlist Navigation Microinteractions
// =============================================================================

// Enhance existing playlist items (builds on _navbar.scss)
.spicetify-playlist-list li {
  @include gradient-ripple(
    rgba(var(--spice-rgb-surface1), var(--feedback-moderate))
  );

  // Enhanced hover state that builds on existing hover background
  &:hover {
    // Preserve existing hover background color
    background-color: var(--spice-main);

    // Add gradient overlay for enhanced depth
    position: relative;

    &::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(
        90deg,
        rgba(var(--spice-rgb-accent), 0.05) 0%,
        rgba(var(--spice-rgb-accent), 0.1) 50%,
        rgba(var(--spice-rgb-accent), 0.05) 100%
      );
      border-radius: 4px;
      pointer-events: none;
      z-index: 1;
    }
  }

  // Enhanced focus state for accessibility
  &:focus-visible {
    outline: 2px solid rgba(var(--spice-rgb-accent), 0.6);
    outline-offset: 2px;
  }
}

// PHASE 4.1: Navigation Button Enhancements
// =============================================================================

// Enhance existing create playlist button
.main-createPlaylistButton-button {
  @include interaction-feedback(1.02, true);
  @include gradient-ripple(
    rgba(var(--spice-rgb-accent), var(--feedback-moderate))
  );

  // Coordinate with existing button styling
  border-radius: 6px;

  &:hover {
    // Enhanced glow effect
    box-shadow: 0 0 12px rgba(var(--spice-rgb-accent), 0.3);
  }
}

// Enhance existing nav bar links
.main-navBar-navBarLink {
  @include interaction-feedback(1.01, false);
  border-radius: 4px;

  // Subtle ripple for navigation
  @include gradient-ripple(
    rgba(var(--spice-rgb-surface1), var(--feedback-subtle))
  );
}

// ══════════════════════════════════════════════════════════════════════════════
// YEAR 3000 CONTROL BUTTON COSMIC ENHANCEMENT - The Hearts of Interaction
// ══════════════════════════════════════════════════════════════════════════════

// Enhanced shuffle and transport buttons with YEAR 3000 visual effects
.main-shuffleButton-button,
.main-skipForwardButton-button,
.main-skipBackButton-button {
  // Kinetic Verb: OSCILLATE - Base breathing (scale removed)
  transform: translateZ(0);

  @include interaction-feedback(
    calc(1.05 + (var(--micro-beat-intensity) * 0.03)),
    true
  );
  @include gradient-ripple(
    rgba(var(--spice-rgb-accent), var(--feedback-moderate))
  );

  // Dynamic filter enhancement
  filter: hue-rotate(var(--micro-hue-shift))
    brightness(calc(1 + (var(--micro-beat-intensity) * 0.08)));
  transition: all var(--micro-fast) var(--sn-easing-explorer, ease-out);

  // Kinetic Verb: BLOOM - Enhanced hover (scale removed)
  &:hover {
    transform: translateZ(0);
    box-shadow: 0 0 var(--micro-glow-radius)
      rgba(var(--spice-rgb-accent), var(--feedback-moderate));
  }

  // Enhanced active state for shuffle button with rhythm visual effects
  &.main-shuffleButton-active {
    --ripple-color: var(--spice-accent);

    // Action Verb: REFRACT - Rhythmic glow for active state
    box-shadow: 0 0 calc(var(--micro-glow-radius) * 1.2)
      rgba(
        var(--spice-rgb-accent),
        calc(0.4 + (var(--micro-beat-intensity) * 0.3))
      );
    text-shadow: 0 0 calc(4px * var(--micro-beat-intensity))
      rgba(var(--spice-rgb-accent), var(--micro-beat-intensity));
  }
}

// Enhanced main play button - THE DYNAMIC CORE 💫
.main-playButton-PlayButton.main-playButton-primary {
  // Action Verb: BLOOM - Maximum visual effects for the most important button
  transform: scale(
    calc(
      var(--micro-breathing-scale) * (1 + (var(--micro-beat-intensity) * 0.05))
    )
  );

  @include interaction-feedback(
    calc(1.08 + (var(--micro-beat-intensity) * 0.05)),
    true
  );
  @include gradient-ripple(
    rgba(var(--spice-rgb-accent), var(--feedback-prominent))
  );

  // Dynamic pulse enhancement
  filter: hue-rotate(var(--micro-hue-shift))
    brightness(calc(1 + (var(--micro-beat-intensity) * 0.12)))
    saturate(calc(1.1 + (var(--micro-beat-intensity) * 0.2)));
  transition: all var(--micro-fast) var(--sn-anim-easing-bounce-smooth);

  // Prominent glow effect with rhythm
  &:hover {
    box-shadow: 0 0 calc(var(--micro-glow-radius) * 2)
      rgba(
        var(--spice-rgb-accent),
        calc(0.5 + (var(--micro-beat-intensity) * 0.3))
      );
    transform: translateZ(0);
  }
}

// PHASE 4.1: Search and Filter Enhancements
// =============================================================================

// Enhance filter and search inputs
.x-filterBox-filterInput {
  @include interaction-feedback(1.01, false);
  border-radius: 6px;

  &:focus {
    // Enhanced focus glow
    box-shadow: 0 0 8px rgba(var(--spice-rgb-accent), 0.3);
    border-color: rgba(var(--spice-rgb-accent), 0.6);
  }
}

// Enhance dropdown interactions
.main-dropDown-dropDown {
  @include interaction-feedback(1.01, false);

  &:focus {
    box-shadow: 0 0 6px rgba(var(--spice-rgb-accent), 0.2);
  }
}

// PHASE 4.1: Track List Microinteractions
// =============================================================================

// Track list playing icon enhancement
.main-trackList-playingIcon {
  @include gradient-ripple(
    rgba(var(--spice-rgb-accent), var(--feedback-moderate))
  );
  border-radius: 4px;

  // Animated glow for playing track
  &::before {
    content: "";
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: linear-gradient(
      45deg,
      rgba(var(--spice-rgb-accent), 0.2) 0%,
      transparent 50%,
      rgba(var(--spice-rgb-accent), 0.2) 100%
    );
    border-radius: inherit;
    z-index: -1;
    animation: playing-glow 2s ease-in-out infinite;
  }

  @keyframes playing-glow {
    0%,
    100% {
      opacity: 0.3;
    }
    50% {
      opacity: 0.7;
    }
  }
}

// PHASE 4.1: Context Menu Enhancement
// =============================================================================

// Enhance existing context menu buttons
.main-contextMenu-menuItemButton {
  @include interaction-feedback(1.02, false);
  @include gradient-ripple(
    rgba(var(--spice-rgb-surface1), var(--feedback-subtle))
  );

  border-radius: 4px;

  &:hover {
    // Subtle gradient background
    background: linear-gradient(
      90deg,
      rgba(var(--spice-rgb-surface1), 0.8) 0%,
      rgba(var(--spice-rgb-surface2), 0.6) 100%
    );
  }
}

// PHASE 4.1: Responsive and Accessibility Enhancements
// =============================================================================

// Mobile optimizations for microinteractions
@media (max-width: 768px) {
  :root {
    --ripple-intensity: var(--feedback-subtle); // Reduce intensity on mobile
    --interaction-feedback-delay: 0.05s; // Faster feedback on touch
  }

  // Simplify ripples on mobile for performance
  .main-card-card,
  .main-card-cardContainer,
  .spicetify-playlist-list li {
    &::after {
      // Smaller ripple scale for mobile
      transform: translate(-50%, -50%) scale(0);
    }

    &:active::after {
      transform: translate(-50%, -50%) scale(15); // Reduced from 20
    }
  }
}

// Reduced motion preferences
@media (prefers-reduced-motion: reduce) {
  .main-card-card,
  .main-card-cardContainer,
  .spicetify-playlist-list li,
  .main-createPlaylistButton-button,
  .main-shuffleButton-button,
  .main-playButton-PlayButton {
    // Keep only opacity transitions (moved above nested rules)
    transition: opacity var(--micro-medium) ease,
      background-color var(--micro-medium) ease;

    // Disable ripple animations
    &::after {
      display: none;
    }

    &:hover {
      transform: none;
    }
  }
}

// High contrast mode support
@media (prefers-contrast: high) {
  :root {
    --ripple-intensity: var(--feedback-prominent); // Increase visibility
    --feedback-subtle: 0.2;
    --feedback-moderate: 0.4;
    --feedback-prominent: 0.6;
  }
}

// =============================================================================
// PHASE 8: YEAR3000 FLUID RIPPLE FEEDBACK INTEGRATION
// Organic interaction feedback with fluid propagation
// =============================================================================

// Track rows get fluid ripple feedback on hover/focus
.main-trackList-trackListRow {
  @include fluid-ripple-feedback;
}

// Navigation links get subtle fluid ripple feedback
.main-navBar-navBarLink {
  @include fluid-ripple-feedback;
}

// Play buttons get prominent fluid ripple feedback
.main-playButton-PlayButton,
.main-playPauseButton-button,
.main-card-PlayButtonContainer button {
  @include fluid-ripple-feedback;
}

// Sidebar interactive elements
.main-yourLibrary-entryPoints button,
.main-createPlaylistButton-button {
  @include fluid-ripple-feedback;
}

// =============================================================================
// LEGACY COMPATIBILITY MAPPINGS - Phase 6.3 Layer B Modernization
// =============================================================================

// Note: This file primarily uses technical terms (ripple, bloom, etc.)
// which are already appropriate. Most terminology was modernized in place
// with minimal legacy mapping needed.
